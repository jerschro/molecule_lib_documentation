
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../read_functions/">
      
      
        <link rel="next" href="../todo/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>API Reference - molecule_lib Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="molecule_lib Documentation" class="md-header__button md-logo" aria-label="molecule_lib Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            molecule_lib Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../read_functions/" class="md-tabs__link">
        
  
    
  
  Read Functions

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../todo/" class="md-tabs__link">
        
  
    
  
  Todo Page

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="molecule_lib Documentation" class="md-nav__button md-logo" aria-label="molecule_lib Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    molecule_lib Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../read_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Functions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#globals-docstrings" class="md-nav__link">
    <span class="md-ellipsis">
      Globals Docstrings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Globals Docstrings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.GLOBALS_DOCSTRINGS" class="md-nav__link">
    <span class="md-ellipsis">
      GLOBALS_DOCSTRINGS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#math-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Math functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Math functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.csc" class="md-nav__link">
    <span class="md-ellipsis">
      csc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.sec" class="md-nav__link">
    <span class="md-ellipsis">
      sec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.cot" class="md-nav__link">
    <span class="md-ellipsis">
      cot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib._isfloatstr" class="md-nav__link">
    <span class="md-ellipsis">
      _isfloatstr
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abc-unitcell-molecule-section" class="md-nav__link">
    <span class="md-ellipsis">
      ABC (Unitcell) Molecule Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ABC (Unitcell) Molecule Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCCoord" class="md-nav__link">
    <span class="md-ellipsis">
      ABCCoord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ABCCoord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCCoord.line" class="md-nav__link">
    <span class="md-ellipsis">
      line
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.LatticeMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      LatticeMatrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LatticeMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.LatticeMatrix.getabc" class="md-nav__link">
    <span class="md-ellipsis">
      getabc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.LatticeMatrix.getanglesdeg" class="md-nav__link">
    <span class="md-ellipsis">
      getanglesdeg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.LatticeMatrix.getanglesrad" class="md-nav__link">
    <span class="md-ellipsis">
      getanglesrad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule" class="md-nav__link">
    <span class="md-ellipsis">
      ABCMolecule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ABCMolecule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.add_coords" class="md-nav__link">
    <span class="md-ellipsis">
      add_coords
    </span>
  </a>
  
    <nav class="md-nav" aria-label="add_coords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.add_coords--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.add_coords--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.add_coords--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.append" class="md-nav__link">
    <span class="md-ellipsis">
      append
    </span>
  </a>
  
    <nav class="md-nav" aria-label="append">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.append--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.append--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.convert--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.convert--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.convert--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.delete" class="md-nav__link">
    <span class="md-ellipsis">
      delete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.delete--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.delete--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.freeze_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      freeze_atoms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="freeze_atoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.freeze_atoms--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.freeze_atoms--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.format" class="md-nav__link">
    <span class="md-ellipsis">
      format
    </span>
  </a>
  
    <nav class="md-nav" aria-label="format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.format--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.format--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.format--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.get_centroid" class="md-nav__link">
    <span class="md-ellipsis">
      get_centroid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_centroid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.get_centroid--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.info" class="md-nav__link">
    <span class="md-ellipsis">
      info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.manipulate" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="manipulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.manipulate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.manipulate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.move" class="md-nav__link">
    <span class="md-ellipsis">
      move
    </span>
  </a>
  
    <nav class="md-nav" aria-label="move">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.move--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.move--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.printt" class="md-nav__link">
    <span class="md-ellipsis">
      printt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.rotate" class="md-nav__link">
    <span class="md-ellipsis">
      rotate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rotate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.rotate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.rotate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
    <nav class="md-nav" aria-label="save">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.save--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.save--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.save--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sort">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.sort--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.sort--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.ABCMolecule.sort--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abc-private-functions" class="md-nav__link">
    <span class="md-ellipsis">
      ABC Private Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ABC Private Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib._islatticematrix" class="md-nav__link">
    <span class="md-ellipsis">
      _islatticematrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib._is3byxfloatmatrix" class="md-nav__link">
    <span class="md-ellipsis">
      _is3byxfloatmatrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib._is6byxfloatselectivematrix" class="md-nav__link">
    <span class="md-ellipsis">
      _is6byxfloatselectivematrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abc-functions" class="md-nav__link">
    <span class="md-ellipsis">
      ABC Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ABC Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.isvasplist" class="md-nav__link">
    <span class="md-ellipsis">
      isvasplist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.create_from_vasp_file_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_from_vasp_file_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.read_vasp" class="md-nav__link">
    <span class="md-ellipsis">
      read_vasp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xyz-no-unitcell-molecule-section" class="md-nav__link">
    <span class="md-ellipsis">
      XYZ (No Unitcell) Molecule Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XYZ (No Unitcell) Molecule Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZCoord" class="md-nav__link">
    <span class="md-ellipsis">
      XYZCoord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XYZCoord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZCoord.line" class="md-nav__link">
    <span class="md-ellipsis">
      line
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule" class="md-nav__link">
    <span class="md-ellipsis">
      XYZMolecule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XYZMolecule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.add_coords" class="md-nav__link">
    <span class="md-ellipsis">
      add_coords
    </span>
  </a>
  
    <nav class="md-nav" aria-label="add_coords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.add_coords--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.add_coords--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.add_coords--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.append" class="md-nav__link">
    <span class="md-ellipsis">
      append
    </span>
  </a>
  
    <nav class="md-nav" aria-label="append">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.append--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.append--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.convert--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.convert--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.delete" class="md-nav__link">
    <span class="md-ellipsis">
      delete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.delete--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.delete--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.format" class="md-nav__link">
    <span class="md-ellipsis">
      format
    </span>
  </a>
  
    <nav class="md-nav" aria-label="format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.format--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.format--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.format--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.get_centroid" class="md-nav__link">
    <span class="md-ellipsis">
      get_centroid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_centroid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.get_centroid--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.info" class="md-nav__link">
    <span class="md-ellipsis">
      info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.manipulate" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="manipulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.manipulate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.manipulate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.move" class="md-nav__link">
    <span class="md-ellipsis">
      move
    </span>
  </a>
  
    <nav class="md-nav" aria-label="move">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.move--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.move--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.printt" class="md-nav__link">
    <span class="md-ellipsis">
      printt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.rotate" class="md-nav__link">
    <span class="md-ellipsis">
      rotate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rotate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.rotate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.rotate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
    <nav class="md-nav" aria-label="save">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.save--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.save--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sort">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.sort--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.sort--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.XYZMolecule.sort--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xyz-functions" class="md-nav__link">
    <span class="md-ellipsis">
      XYZ Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XYZ Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib.isturbomolelist" class="md-nav__link">
    <span class="md-ellipsis">
      isturbomolelist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.create_from_turbomole_file_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_from_turbomole_file_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.read_turbomole" class="md-nav__link">
    <span class="md-ellipsis">
      read_turbomole
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.isxyzlist" class="md-nav__link">
    <span class="md-ellipsis">
      isxyzlist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.create_from_xyz_file_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_from_xyz_file_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.read_xyz" class="md-nav__link">
    <span class="md-ellipsis">
      read_xyz
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-file-reading-formats" class="md-nav__link">
    <span class="md-ellipsis">
      More File Reading Formats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="More File Reading Formats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#molecule_lib._is_xsf_coord_line" class="md-nav__link">
    <span class="md-ellipsis">
      _is_xsf_coord_line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib._determine_rest_of_xsf_file" class="md-nav__link">
    <span class="md-ellipsis">
      _determine_rest_of_xsf_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.isxsflist" class="md-nav__link">
    <span class="md-ellipsis">
      isxsflist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.create_from_xsf_file_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_from_xsf_file_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.read_xsf" class="md-nav__link">
    <span class="md-ellipsis">
      read_xsf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.issiestalist" class="md-nav__link">
    <span class="md-ellipsis">
      issiestalist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.create_from_siesta_file_data" class="md-nav__link">
    <span class="md-ellipsis">
      create_from_siesta_file_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#molecule_lib.read_siesta" class="md-nav__link">
    <span class="md-ellipsis">
      read_siesta
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Todo Page
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="reference-documentation">Reference Documentation</h1>
<h2 id="globals-docstrings">Globals Docstrings</h2>


<div class="doc doc-object doc-class">



<h3 id="molecule_lib.GLOBALS_DOCSTRINGS" class="doc doc-heading">
          <code>molecule_lib.GLOBALS_DOCSTRINGS</code>


</h3>


  <div class="doc doc-contents first">

  



  <p>Attributes:</p>
  <ul>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.ACCEPTED_ELEMENTS">ACCEPTED_ELEMENTS</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.Lx">Lx</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.Fx">Fx</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.La">La</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.Fa">Fa</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.Sa">Sa</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.Lc">Lc</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.Fc">Fc</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.UC_90_ANGLE_MAX">UC_90_ANGLE_MAX</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.UC_90_ANGLE_MIN">UC_90_ANGLE_MIN</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.MolIndex">MolIndex</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="molecule_lib.GLOBALS_DOCSTRINGS.MOLAR_MASS">MOLAR_MASS</span></code></b>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
  </ul>


  </div>


</div><h2 id="math-functions">Math functions</h2>



<div class="doc doc-object doc-function">



<h3 id="molecule_lib.csc" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">csc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return the cosecant of x (measured in radians).</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">csc</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>  <span class="c1"># used in molecule.py</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cosecant of x (measured in radians).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.sec" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return the secant of x (measured in radians).</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sec</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>  <span class="c1"># used in molecule.py</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the secant of x (measured in radians).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.cot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return the cotangent of x (measured in radians).</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cot</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>  <span class="c1"># used in molecule.py</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the cotangent of x (measured in radians).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib._isfloatstr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">_isfloatstr</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return True if item is float string, False otherwise.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_isfloatstr</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if item is float string, False otherwise.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h2 id="abc-unitcell-molecule-section">ABC (Unitcell) Molecule Section</h2>


<div class="doc doc-object doc-class">



<h3 id="molecule_lib.ABCCoord" class="doc doc-heading">
          <code>molecule_lib.ABCCoord</code>


</h3>


  <div class="doc doc-contents first">

  
      <p>Dataclass for atomic coordinates for use in ABCMolecule class.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>sp</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p>Species of atom.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>a</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>a or x coordinate position of atom.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>b</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>b or y coordinate position of atom.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>c</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>c or z coordinate position of atom.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCCoord" href="#molecule_lib.ABCCoord">ABCCoord</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

            <details class="quote">
              <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ABCCoord</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass for atomic coordinates for use in ABCMolecule class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sp : str</span>
<span class="sd">        Species of atom.</span>
<span class="sd">    a : float</span>
<span class="sd">        a or x coordinate position of atom.</span>
<span class="sd">    b : float</span>
<span class="sd">        b or y coordinate position of atom.</span>
<span class="sd">    c : float</span>
<span class="sd">        c or z coordinate position of atom.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCCoord</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCCoord.__init__() required postional argument &#39;sp&#39; is not an accepted species string&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCCoord.__init__() required positional argument &#39;x&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCCoord.__init__() required positional argument &#39;y&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCCoord.__init__() required positional argument &#39;z&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="o">=</span> <span class="n">sp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># when you are in kernel and run object with enter</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ABCCoord(sp=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">}</span><span class="s2">&#39;, x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">}</span><span class="s2">, z=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># by using str() or print()</span>
        <span class="c1"># also might need to create XYZCoord.line() method because this return was used in editor i think</span>
        <span class="c1"># return f&quot;{self.sp:&gt;4} {self.x:&gt;{Lc}.{Fc}f}{self.y:&gt;{Lc}.{Fc}f}{self.z:&gt;{Lc}.{Fc}f}&quot;</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ABCCoord(sp=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">}</span><span class="s2">&#39;, x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">}</span><span class="s2">, z=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># needed for something... i think it was indexing but not 100% positive</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;ABCCoord.__getitem__() Index out of list.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCCoord.line" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">line</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="molecule_lib.LatticeMatrix" class="doc doc-heading">
          <code>molecule_lib.LatticeMatrix</code>


</h3>


  <div class="doc doc-contents first">

  
      <p>Dataclass for ABCMolecule Class.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>constant</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>vector_1</code></b>
            (<code><span title="typing.Union">Union</span>[float, float, float]</code>)
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>vector_2</code></b>
            (<code><span title="typing.Union">Union</span>[float, float, float]</code>)
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>vector_3</code></b>
            (<code><span title="typing.Union">Union</span>[float, float, float]</code>)
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.LatticeMatrix" href="#molecule_lib.LatticeMatrix">LatticeMatrix</a></code>
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Notes</summary>
  <p>Other Attributes Generated:
    a: float
    b: float
    c: float
    alp: float
    bet: float
    gam: float
    volume: float</p>
</details>
            <details class="quote">
              <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LatticeMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass for ABCMolecule Class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    constant : float</span>
<span class="sd">        __description__</span>
<span class="sd">    vector_1 : Union[float,float,float]</span>
<span class="sd">        __description__</span>
<span class="sd">    vector_2 : Union[float,float,float]</span>
<span class="sd">        __description__</span>
<span class="sd">    vector_3 : Union[float,float,float]</span>
<span class="sd">        __description__</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LatticeMatrix</span>
<span class="sd">        __description__</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Other Attributes Generated:</span>
<span class="sd">        a: float</span>
<span class="sd">        b: float</span>
<span class="sd">        c: float</span>
<span class="sd">        alp: float</span>
<span class="sd">        bet: float</span>
<span class="sd">        gam: float</span>
<span class="sd">        volume: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constant</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">vector_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">vector_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">vector_3</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">constant</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LatticeMatrix.__init__() required positional argument &#39;constant&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">vector</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;vector_1&quot;</span><span class="p">,</span> <span class="s2">&quot;vector_2&quot;</span><span class="p">,</span> <span class="s2">&quot;vector_3&quot;</span><span class="p">],[</span><span class="n">vector_1</span><span class="p">,</span> <span class="n">vector_2</span><span class="p">,</span> <span class="n">vector_3</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LatticeMatrix.__init__() required positional argument &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not a list&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LatticeMatrix.__init__() required positional argument &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not a list of length 3&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LatticeMatrix.__init__() required positional argument &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constant</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">constant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector_3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="p">))</span> <span class="o">/</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="p">))</span> <span class="o">/</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="p">))</span> <span class="o">/</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">)</span> <span class="o">-</span>
             <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bet</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gam</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># when you are in kernel and run object with enter</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;LatticeMatrix(constant=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">constant</span><span class="si">}</span><span class="s2">, vector_1=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="si">}</span><span class="s2">, vector_2=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="si">}</span><span class="s2">, vector_3=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># by using str() or print()</span>
        <span class="c1"># also might need to create XYZCoord.line() method because this return was used in editor i think</span>
        <span class="c1"># return f&quot;{self.sp:&gt;4} {self.x:&gt;{Lc}.{Fc}f}{self.y:&gt;{Lc}.{Fc}f}{self.z:&gt;{Lc}.{Fc}f}&quot;</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;LatticeMatrix(constant=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">constant</span><span class="si">}</span><span class="s2">, vector_1=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_1</span><span class="si">}</span><span class="s2">, vector_2=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_2</span><span class="si">}</span><span class="s2">, vector_3=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_3</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">getabc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns sidelengths (a,b,c) of unitcell.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>

    <span class="k">def</span> <span class="nf">getanglesdeg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns (alpha, beta, gamma) of unitcell in degrees.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">bet</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gam</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">getanglesrad</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns (alpha, beta, gamma) of unitcell in radians.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gam</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="molecule_lib.LatticeMatrix.getabc" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">getabc</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns sidelengths (a,b,c) of unitcell.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getabc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns sidelengths (a,b,c) of unitcell.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.LatticeMatrix.getanglesdeg" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">getanglesdeg</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns (alpha, beta, gamma) of unitcell in degrees.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getanglesdeg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns (alpha, beta, gamma) of unitcell in degrees.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">bet</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gam</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.LatticeMatrix.getanglesrad" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">getanglesrad</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns (alpha, beta, gamma) of unitcell in radians.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getanglesrad</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns (alpha, beta, gamma) of unitcell in radians.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gam</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="molecule_lib.ABCMolecule" class="doc doc-heading">
          <code>molecule_lib.ABCMolecule</code>


</h3>


  <div class="doc doc-contents first">

  
      <p>Class for ABC molecule object.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>unitcell</code></b>
            (<code><a class="autorefs autorefs-internal" title="molecule_lib.LatticeMatrix" href="#molecule_lib.LatticeMatrix">LatticeMatrix</a></code>)
        –
        <div class="doc-md-description">
          <p>Instance of LatticeMatrix dataclass needed for ABCMolecule class.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atoms</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="molecule_lib.ABCCoord" href="#molecule_lib.ABCCoord">ABCCoord</a>]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>positional</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
          <p>If True, given ABCCoords are positional coordinates. If False, given ABCCoords are cartesian coordinates in Angstroms.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>comment_line</code></b>
            (<code>str</code>, default:
                <code>is &#34; &#34;</code>
)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>filetype</code></b>
            (<code>str</code>, default:
                <code>&#39;unitcell&#39;</code>
)
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

            <details class="quote">
              <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for ABC molecule object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    unitcell : LatticeMatrix</span>
<span class="sd">        Instance of LatticeMatrix dataclass needed for ABCMolecule class.</span>
<span class="sd">    atoms : list[ABCCoord]</span>
<span class="sd">        _description_</span>
<span class="sd">    positional : bool, default True</span>
<span class="sd">        If True, given ABCCoords are positional coordinates. If False, given ABCCoords are cartesian coordinates in Angstroms.</span>
<span class="sd">    comment_line : str, default is &quot; &quot;</span>
<span class="sd">        _description_</span>
<span class="sd">    filetype: str</span>
<span class="sd">        __description__</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">unitcell</span><span class="p">:</span> <span class="n">LatticeMatrix</span><span class="p">,</span>
                 <span class="n">positional</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                 <span class="n">atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">],</span>
                 <span class="n">comment_line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
                 <span class="n">frozen_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]],</span>
                 <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unitcell&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.__init__() index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> of atoms is not type ABCCoord; item = </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span> <span class="o">=</span> <span class="n">unitcell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positional</span> <span class="o">=</span> <span class="n">positional</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">comment_line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">frozen_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates other instance variables from initial variables given.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_type</span> <span class="o">=</span> <span class="n">ABCCoord</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Atoms input not all type ABCCoord&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="s2">&quot;__&quot;</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">_</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">sp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ABCMolecule(unitcell=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="si">}</span><span class="s2">, atoms=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s2">, positional=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="si">}</span><span class="s2">, comment_line=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&#39;, filetype=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">ABCMolecule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ABCMolecule</span><span class="p">):</span>
            <span class="n">new_coords</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.__add__() can only add type ABCMolecule&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_coords</span><span class="o">=</span><span class="n">new_coords</span><span class="p">,</span>
                           <span class="n">positional</span><span class="o">=</span><span class="kc">True</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        index type is int | str | list[int] | list[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
                <span class="k">if</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                       <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
                                       <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)]],</span>
                                       <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                                       <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                       <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
                                       <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]],</span>
                                       <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                                       <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.__getitem__() int is out of range of len(self.atoms) or is zero&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
                    <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                    <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">index</span><span class="p">],</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
                    <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                    <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_molden_index</span><span class="p">(</span><span class="n">index</span><span class="p">)]],</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
                    <span class="k">if</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.__getitem__() int is out of range of len(self.atoms)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">ele</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">ele</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">item</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_molden_index</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span>
            <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                               <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
                               <span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span>
                               <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                               <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.__getitem__() not valid index&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_molden_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule._get_molden_index() index type not correct&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">_n1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">_a1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
                <span class="n">_n1</span> <span class="o">+=</span> <span class="n">item</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_a1</span> <span class="o">+=</span> <span class="n">item</span>
        <span class="n">_n2</span> <span class="o">=</span> <span class="n">_n1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_n2</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule._get_molden_index() no # after&quot;</span><span class="p">)</span>
        <span class="n">_a2</span> <span class="o">=</span> <span class="n">_a1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="n">_a2</span> <span class="o">+</span> <span class="n">_n2</span><span class="p">:</span>
            <span class="n">_n3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_n2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_a2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule._get_molden_index() Sp not in self.speciesline&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                    <span class="n">_a2</span><span class="p">)])</span> <span class="o">&gt;=</span> <span class="n">_n3</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">_a2</span><span class="p">][</span><span class="n">_n3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule._get_molden_index() # is too large or zero&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule._get_molden_index() Sp# out of order&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_item</span><span class="p">:</span> <span class="n">ABCCoord</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.__setitem__() index must be of type int or str&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_item</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">new_item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.__setitem__() Value assignment must be type XYZCoord&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="k">def</span> <span class="nf">add_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">molecule</span><span class="p">:</span> <span class="n">ABCMolecule</span> <span class="o">|</span> <span class="n">XYZMolecule</span><span class="p">,</span>
                   <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
                   <span class="n">absorbent_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ABCCoord</span><span class="p">,</span>
                   <span class="n">surface_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ABCCoord</span><span class="p">,</span>
                   <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new Molecule object to the current ABCMolecule object very precisely.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        molecule : ABCMolecule or XYZMolecule</span>
<span class="sd">            _description_</span>
<span class="sd">        axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">            Placement of new molecule will be in direction of axis.</span>
<span class="sd">        absorbent_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">            _description_</span>
<span class="sd">        surface_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">            _description_</span>
<span class="sd">        dist : float</span>
<span class="sd">            sign of float determines what direction the new molecule is placed.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule</span>
<span class="sd">            ABCMolecule with new atoms added.</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        Need to add CoordType logic.</span>
<span class="sd">        Need to add ABCMolecule logic.</span>
<span class="sd">        NEED TO ADD absorbent/surface reference can of type coord also probably need coord protocol</span>
<span class="sd">        NEED TO ADD LOGIC FOR CONVERTING TO DIFFERENT ATOM TYPES</span>
<span class="sd">        operation happens in cartesian coordinates and then the new coords are converted back to positional</span>
<span class="sd">        need to ensure operation only happens in a trigonal unit cell until i find the generic unitcell formula</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.add_coords() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; or 1 or 2 or 3 &quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">match</span> <span class="n">axis</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">case</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">ABCMolecule</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">molecule</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                <span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">XYZMolecule</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.add_coords() required argument &#39;molecule&#39; not correct type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="c1"># needed to not append to memory and return only changed object</span>
        <span class="n">combined_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="c1"># need convert bc operation happens in cartesian coords</span>
        <span class="n">sur_centroids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="n">sur_centroids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">x_import_centroid</span><span class="p">,</span> <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">(</span>
        <span class="p">)</span>
        <span class="n">abs_centroids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x_import_centroid</span><span class="p">,</span> <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span>
        <span class="p">]</span>
        <span class="n">x_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">y_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">z_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">abs_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_import_list</span><span class="p">,</span> <span class="n">y_import_list</span><span class="p">,</span> <span class="n">z_import_list</span><span class="p">)</span>
        <span class="n">atom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
        <span class="n">x_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">atom_list</span><span class="p">]</span>
        <span class="n">y_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">atom_list</span><span class="p">]</span>
        <span class="n">z_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">atom_list</span><span class="p">]</span>
        <span class="n">sur_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_curr_list</span><span class="p">,</span> <span class="n">y_curr_list</span><span class="p">,</span> <span class="n">z_curr_list</span><span class="p">)</span>
        <span class="c1"># finding absorbent values</span>
        <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
            <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
        <span class="k">elif</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
            <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
            <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if absorbent_reference == &quot;Bottom&quot;:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
            <span class="n">abs_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">abs_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">abs_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="c1"># finding surface values now</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">surface_reference</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.add_coords() required argument &#39;surface_reference&#39; is not type str or ABCCoord.&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
            <span class="n">sur_mod</span> <span class="o">=</span> <span class="n">sur_centroids</span>
        <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;(0.5,0.5,0.5)&quot;</span><span class="p">:</span>
            <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
            <span class="c1"># if surface_reference == ABSORBENT_OPTIONS[&#39;starting_surface_list&#39;][1]:</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
            <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">sur_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span> <span class="ow">or</span> <span class="s2">&quot;Most negative&quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
            <span class="n">species</span> <span class="o">=</span> <span class="n">surface_reference</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span>
            <span class="k">if</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if &quot;Most negative&quot; in surface_reference:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
            <span class="n">species_import_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">axis_int</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
                <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">species</span>
            <span class="p">]</span>
            <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">species_import_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># necessary for add atom</span>
            <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># if surface_reference == &#39;origin&#39;</span>
        <span class="c1"># math for finding displacement distanceance</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="n">distance</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span>
        <span class="c1"># print(f&#39;{sur_mod = }&#39;)</span>
        <span class="c1"># print(f&#39;{abs_mod = }&#39;)</span>
        <span class="n">x_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                <span class="n">combined_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">ABCCoord</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_mod</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span><span class="p">,</span>
                             <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y_mod</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">,</span>
                             <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">z_mod</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">combined_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">ABCCoord</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_mod</span><span class="p">,</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y_mod</span><span class="p">,</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">z_mod</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">combined_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">combined_atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">new_coords</span><span class="p">:</span> <span class="n">ABCCoord</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">],</span>
               <span class="n">positional</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
               <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;To add coords to the current self.atoms attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_coords : ABCCoord or list[ABCCoord]</span>
<span class="sd">            List of new coords to add to new object.</span>
<span class="sd">        positional : bool</span>
<span class="sd">            True if coords are positional coordinates. False if they are cartesian coordinates.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_coords</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_coords</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.__init__() index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> of atoms is not type ABCCoord; item = </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="n">positional</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
            <span class="n">converted_coords</span> <span class="o">=</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                           <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
                                           <span class="n">atoms</span><span class="o">=</span><span class="n">new_coords</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">atoms</span>
            <span class="n">new_coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="p">[</span>
                <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ABCCoord</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                                           <span class="n">coord</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">converted_coords</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">positional</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
            <span class="n">converted_coords</span> <span class="o">=</span> <span class="n">new_coords</span>
            <span class="c1"># CONVERTING CARTESIAN TO POSITIONAL COORDS</span>
            <span class="p">[</span>
                <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">ABCCoord</span><span class="p">(</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">a</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">b</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="p">))</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">converted_coords</span>
            <span class="p">]</span>
        <span class="n">new_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="n">new_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_coords</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">new_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;trig&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts ABCMolecule to XYZMolecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str, &quot;{&#39;general&#39; or &#39;trig&#39; or &#39;linalg&#39;}&quot; default &#39;trig&#39;</span>
<span class="sd">            Which method you want to use for converting ABCMolecule positional coords to, cartesian coordinates.</span>
<span class="sd">                &#39;general&#39; is the general formula.</span>
<span class="sd">                &#39;trig&#39; looks most correct and is the default.</span>
<span class="sd">                &#39;linalg&#39; is an unfinished method using linear algebra concepts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule</span>
<span class="sd">            _description_</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Maybe we can use Tristan&#39;s paid chatgpt for it to help me</span>
<span class="sd">            figure out the different methods and what is going on exactly.</span>
<span class="sd">        Notes on different methods:</span>
<span class="sd">        &#39;linalg&#39; is jerry&#39;s method that is unfinished</span>
<span class="sd">        &#39;general&#39; is the wikipedia formula which is supposedly the general solution but something is wrong about it</span>
<span class="sd">        &#39;trig&#39; is default and is what I believe is the correct method. Lowkey got it from chatgpt but it is correct.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">,</span> <span class="s2">&quot;trig&quot;</span><span class="p">,</span> <span class="s2">&quot;linalg&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.convert() optional argument &#39;method&#39; is not &#39;general&#39;,&#39;trig&#39; or &#39;linalg&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;general&quot;</span><span class="p">:</span>
                <span class="c1"># ====================================</span>
                <span class="c1"># former code using wikipedia resource....</span>
                <span class="c1"># =====================================</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
                <span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getanglesrad</span><span class="p">()</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
                    <span class="p">[</span>
                        <span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span>
                        <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span>
                                  <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
                        <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">0</span><span class="p">,</span>
                    <span class="p">],</span>
                    <span class="p">[</span>
                        <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">),</span>
                        <span class="n">b</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">alp</span><span class="p">),</span>
                        <span class="mi">0</span><span class="p">,</span>
                    <span class="p">],</span>
                    <span class="p">[</span><span class="n">a</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">),</span> <span class="n">c</span><span class="p">],</span>
                <span class="p">])</span>
                <span class="n">convert_atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
                        <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">a</span><span class="p">],</span>
                        <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">b</span><span class="p">],</span>
                        <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">c</span><span class="p">],</span>
                    <span class="p">])</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                    <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">XYZCoord</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                 <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
                <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;trig&quot;</span><span class="p">:</span>
                <span class="c1"># ====================================</span>
                <span class="c1"># created using chatgpt as a resource.</span>
                <span class="c1"># quote &quot;correct&quot; method</span>
                <span class="c1"># =====================================</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
                <span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getanglesrad</span><span class="p">()</span>
                <span class="n">convert_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                    <span class="n">x_car</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>
                    <span class="n">y_car</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">/</span> <span class="n">sin</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">c</span>
                    <span class="n">z_car</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                                     <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span>
                                     <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">c</span>
                    <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">x_car</span><span class="p">,</span> <span class="n">y_car</span><span class="p">,</span>
                                                  <span class="n">z_car</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if method == &#39;linalg&#39;</span>
                <span class="c1"># ==================================</span>
                <span class="c1"># jerry&#39;s method not fully correct</span>
                <span class="c1"># ==================================</span>
                <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_2</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_3</span>
                <span class="p">])</span>
                <span class="n">Coord_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">atom</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">atom</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
                               <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]))</span>
                <span class="n">transform_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">constant</span> <span class="o">*</span>
                                                <span class="p">(</span><span class="n">L</span> <span class="o">*</span> <span class="n">Coord_matrix</span><span class="p">))</span>
                <span class="n">convert_atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">transform_matrix</span><span class="p">):</span>
                    <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">XYZCoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
                <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                <span class="n">atoms</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
                <span class="p">],</span>
                <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete INDEXED atoms in ABCMolecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : MolIndex</span>
<span class="sd">            _description_</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule</span>
<span class="sd">            ABCMolecule with selected atoms deleted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">saving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">del_ints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">del_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
        <span class="n">saving_atoms</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">del_ints</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">saving_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">saving_atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">freeze_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span>
                     <span class="n">freeze_indexed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                     <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : MolIndex</span>
<span class="sd">            _description_</span>
<span class="sd">        freeze_indexed : bool</span>
<span class="sd">            _description_</span>
<span class="sd">        inplace : bool, optional</span>
<span class="sd">            _description_, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">indexed_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
            <span class="n">false_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">true_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">indexed_mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                    <span class="n">false_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">coord</span><span class="p">)</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="n">true_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">true_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">coord</span><span class="p">)</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="n">false_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">false_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="n">true_atoms</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>

        <span class="n">frozen_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">false_atoms</span><span class="p">:</span>
                <span class="n">frozen_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">true_atoms</span><span class="p">:</span>
                <span class="n">frozen_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.freeze_atoms() runtime error. coord not in false_atoms or true_atoms&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span> <span class="o">=</span> <span class="n">frozen_atoms</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">frozen_atoms</span><span class="o">=</span><span class="n">frozen_atoms</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endline</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns formatted text for textbox or filewrite.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        endline : str, default &quot; &quot;</span>
<span class="sd">            Endline string for each file line.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[str]</span>
<span class="sd">            list of strings for vasp format with endline str as last character in string.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Can replace text.append self.atoms with abcCoord.line()</span>
<span class="sd">        need to add selective logic and information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">_format_species</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ele</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">_len</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">]</span>
        <span class="n">_format_amount</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ele</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">_len</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">]</span>
        <span class="n">text</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">constant</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_2</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_3</span>
        <span class="p">]:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_format_species</span><span class="p">)</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_format_amount</span><span class="p">)</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span> <span class="o">!=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]]:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Selective Dynamics </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Cartesian&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Direct&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span> <span class="o">!=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]]:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
                <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Sa</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">Sa</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">Sa</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
                <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="k">def</span> <span class="nf">get_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns 3d centroid of ABCMolecule atoms.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[float,float,float]</span>
<span class="sd">            Tuple of (x_centroid,y_centroid,z_centroid) in units Angstroms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">a</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">b</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">z_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">c</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">x_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
        <span class="n">y_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
        <span class="n">z_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_centroid</span><span class="p">,</span> <span class="n">y_centroid</span><span class="p">,</span> <span class="n">z_centroid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints ABCMolecule current attribute information to terminal.&quot;&quot;&quot;</span>
        <span class="n">species_key</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span>
        <span class="p">]</span>
        <span class="n">amount_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">sp</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">species_key</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">ele</span><span class="p">,</span> <span class="n">amt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">):</span>
            <span class="n">curr_value</span> <span class="o">=</span> <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">curr_value</span><span class="p">)</span>
            <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_value</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type: ABCMolecule</span><span class="se">\n</span><span class="s2">filetype: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="se">\n</span><span class="s2">total atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="se">\n</span><span class="s2">species info: </span><span class="si">{</span><span class="n">amount_dict</span><span class="si">}</span><span class="se">\n</span><span class="s2">comment line: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">lattice constant: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">constant</span><span class="si">}</span><span class="se">\n</span><span class="s2">lattice matrix:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_1</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_2</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_3</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="k">def</span> <span class="nf">manipulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span>
                   <span class="n">func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                   <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotate or move only INDEXED atoms in ABCMolecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : MolIndex</span>
<span class="sd">            _description_</span>
<span class="sd">        func : &quot;{&#39;move&#39; or &#39;rotate&#39;}&quot;</span>
<span class="sd">            ABCMolecule method you want to execute on the indexed atoms.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>
<span class="sd">        *args,**kwargs</span>
<span class="sd">            Needed for the chosen function &#39;move&#39; or &#39;rotate&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule or None</span>
<span class="sd">            ABCMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">moving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
                <span class="n">moving_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
        <span class="n">moving_mol</span> <span class="o">=</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                 <span class="n">atoms</span><span class="o">=</span><span class="n">moving_atoms</span><span class="p">,</span>
                                 <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
            <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;rotate&quot;</span><span class="p">:</span>
            <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.manipulate() required argument &#39;func&#39; not &#39;move&#39; or &#39;rotate&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">new_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i_list</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">):</span>
            <span class="n">new_atoms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
             <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
             <span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
             <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move atoms in designated directions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float, default 0.0</span>
<span class="sd">            Move coord in x direction by float amount.</span>
<span class="sd">        y : float, default 0.0</span>
<span class="sd">            Move coord in y direction by float amount.</span>
<span class="sd">        z : float, default 0.0</span>
<span class="sd">            Move coord in z direction by float amount.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule or None</span>
<span class="sd">            ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;x&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;y&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;z&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;inplace&#39; is not a bool&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span>
            <span class="n">x_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">a</span>
            <span class="n">y_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">b</span>
            <span class="n">z_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">c</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ABCCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">sp</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">x_old</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">y_old</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z_old</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">printt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints save file text to terminal.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # def rotate(self, axis : str, angle: float, unit: str =&#39;deg&#39;, about_centroid: bool = True, inplace: bool = False) -&gt; ABCMolecule:</span>
<span class="sd">    #     Rotate atoms about designated axis.</span>

<span class="sd">    #     Parameters</span>
<span class="sd">    #     ----------</span>
<span class="sd">    #     axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">    #         Parallel axis of rotation.</span>
<span class="sd">    #     angle : float</span>
<span class="sd">    #         Angle of rotation.</span>
<span class="sd">    #     unit : &quot;deg&quot; or &quot;rad&quot;, default &quot;deg&quot;</span>
<span class="sd">    #         Unit of angle argument.</span>
<span class="sd">    #     about_centroid : bool, default True</span>
<span class="sd">    #         If True, rotation occurs about the centroid.</span>
<span class="sd">    #     inplace : bool, default False</span>
<span class="sd">    #         If True, perform operation in-place.</span>

<span class="sd">    #     Returns</span>
<span class="sd">    #     -------</span>
<span class="sd">    #     ABCMolecule or None</span>
<span class="sd">    #         ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">    #     </span>
<span class="sd">    #     if axis not in [&#39;x&#39;,&#39;y&#39;,&#39;z&#39;]:</span>
<span class="sd">    #         raise ValueError(f&quot;ABCMolecule.move() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; &quot;) # yapf: disable </span>
<span class="sd">    #     if type(angle) not in [int, float]:</span>
<span class="sd">    #         raise ValueError(f&quot;ABCMolecule.rotate() required argument &#39;angle&#39; is not a number&quot;) # yapf: disable </span>
<span class="sd">    #     if unit not in [&#39;deg&#39;,&#39;rad&#39;]:</span>
<span class="sd">    #         raise ValueError(f&quot;ABCMolecule.rotate() required argument &#39;unit&#39; is not &#39;deg&#39; or &#39;rad&#39;&quot;) # yapf: disable </span>
<span class="sd">    #     if not isinstance(inplace, bool):</span>
<span class="sd">    #         raise ValueError(&quot;ABCMolecule.rotate() optional argument &#39;inplace&#39; is not a bool&quot;) # yapf: disable </span>
<span class="sd">    #     for angle in self.unitcell.getanglesdeg():</span>
<span class="sd">    #         if angle &gt; UC_90_ANGLE_MAX or angle &lt; UC_90_ANGLE_MIN:</span>
<span class="sd">    #             raise ValueError(f&quot;ABCMolecule.rotate() rotation is not possible due to the unit cell not being triclicinic&quot;) # yapf: disable </span>
<span class="sd">    #     if unit == &#39;deg&#39;:</span>
<span class="sd">    #         angle *= pi / 180</span>
<span class="sd">    #     print(f&quot;{axis = }&quot;)</span>
<span class="sd">    #     print(f&#39;{angle = }&#39;)</span>
<span class="sd">    #     print(f&#39;{unit = }&#39;)</span>
<span class="sd">    #     print(f&#39;{about_centroid = }&#39;)</span>
<span class="sd">    #     print(f&#39;{inplace = }&#39;)</span>
<span class="sd">    #     self.__repr__()</span>
<span class="sd">    #     match axis:</span>
<span class="sd">    #         case &#39;x&#39;:</span>
<span class="sd">    #             def rotation(x: float, y: float, z: float) -&gt; tuple[float, float, float]:</span>
<span class="sd">    #                 return x, y*cos(angle) - z*sin(angle), y*sin(angle)+z*cos(angle)</span>
<span class="sd">    #         case &#39;y&#39;:</span>
<span class="sd">    #             def rotation(x: float, y: float, z: float) -&gt; tuple[float, float, float]:</span>
<span class="sd">    #                 return x*cos(angle) + z*sin(angle), y, z*cos(angle) - x*sin(angle)</span>
<span class="sd">    #         case &#39;z&#39;:</span>
<span class="sd">    #             def rotation(x: float, y: float, z: float) -&gt; tuple[float, float, float]:</span>
<span class="sd">    #                 return x*cos(angle) - y*sin(angle), x*sin(angle) + y*cos(angle), z    </span>
<span class="sd">    #     return_atoms: list[ABCCoord] = list()</span>
<span class="sd">    #     if self.positional:</span>
<span class="sd">    #         rotate_atom = self.convert()</span>
<span class="sd">    #     else:</span>
<span class="sd">    #         rotate_atom = self</span>
<span class="sd">    #     print(f&#39;{rotate_atom = !s}&#39;)</span>
<span class="sd">    #     if about_centroid:</span>
<span class="sd">    #         x_cent, y_cent, z_cent = rotate_atom.get_centroid()</span>
<span class="sd">    #     else:</span>
<span class="sd">    #         x_cent = y_cent = z_cent = 0.0</span>
<span class="sd">    #     print(f&#39;{x_cent = }&#39;)</span>
<span class="sd">    #     print(f&#39;{y_cent = }&#39;)</span>
<span class="sd">    #     print(f&#39;{z_cent = }&#39;)</span>
<span class="sd">    #     for coord in rotate_atom.atoms:</span>
<span class="sd">    #         rot_x, rot_y, rot_z = rotation(float(coord[1])-x_cent, float(coord[2])-y_cent, float(coord[3])-z_cent)</span>
<span class="sd">    #         if self.positional:</span>
<span class="sd">    #             rot_x /= self.unitcell.getabc()[0]</span>
<span class="sd">    #             rot_y /= self.unitcell.getabc()[1]</span>
<span class="sd">    #             rot_z /= self.unitcell.getabc()[2]</span>
<span class="sd">    #         return_atoms.append(ABCCoord(sp=coord.sp,a=rot_x+x_cent,b=rot_y+y_cent,c=rot_z+z_cent))</span>
<span class="sd">    #     if inplace:</span>
<span class="sd">    #         self.atoms = return_atoms</span>
<span class="sd">    #         self.__post_init__()</span>
<span class="sd">    #     print(f&#39;{return_atoms = }&#39;)</span>
<span class="sd">    #     return ABCMolecule(unitcell=self.unitcell,positional=self.positional,atoms=return_atoms,comment_line=self.comment_line)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
               <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;deg&quot;</span><span class="p">,</span>
               <span class="n">about_centroid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
               <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotate atoms about designated axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">            Parallel axis of rotation.</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle of rotation.</span>
<span class="sd">        unit : &quot;deg&quot; or &quot;rad&quot;, default &quot;deg&quot;</span>
<span class="sd">            Unit of angle argument.</span>
<span class="sd">        about_centroid : bool, default True</span>
<span class="sd">            If True, rotation occurs about the centroid.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule or None</span>
<span class="sd">            ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rotate_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
        <span class="n">rotate_mol</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                          <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span>
                          <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                          <span class="n">about_centroid</span><span class="o">=</span><span class="n">about_centroid</span><span class="p">,</span>
                          <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">convert_mol</span> <span class="o">=</span> <span class="n">rotate_mol</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">lattice_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                         <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">)</span>
        <span class="n">convert_mol</span><span class="o">.</span><span class="n">comment_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">convert_mol</span><span class="o">.</span><span class="n">atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">convert_mol</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save ABCMolecule instance to given filename in vasp format in current working directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Name you want the saved file to be.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filename in current working directory.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Eventually add for other file types...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                <span class="n">openfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">sort_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
             <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the atoms by position, species, alphabetical or atomic number.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sort_method : str | list[str] | list[list[str]]</span>
<span class="sd">            Method given by which the atoms will be sorted.</span>
<span class="sd">                - if sort_method is &#39;x&#39; the atoms will be sorted by their x coordinate.</span>
<span class="sd">                - if sort_method is &#39;y&#39; the atoms will be sorted by their y coordinate.</span>
<span class="sd">                - if sort_method is &#39;z&#39; the atoms will be sorted by their z coordinate.</span>
<span class="sd">                - if sort_method is &#39;alphabetical&#39; the atoms will be sorted in alphabetical order by their species.</span>
<span class="sd">                - if sort_method is &#39;periodical&#39; the atoms will be sorted by their atomic number.</span>
<span class="sd">            You can also supply a list of lists with position 0 being species and position 1 being &#39;x&#39;,&#39;y&#39;,&#39;z&#39;, or None.</span>
<span class="sd">                This will sort the coordinates by species then by the method provided for each species,</span>
<span class="sd">                you can also add a list of bool for ascending values that will correspond to each species chosen method.</span>
<span class="sd">            You can also supply a list of species and it will be reordered to the given order.</span>
<span class="sd">        ascending : bool or list of bool, default True</span>
<span class="sd">            Sort ascending vs. descending. Specify list for multiple sort orders (as described above). If this is a list of bools, must match the length of sort_method.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule or None</span>
<span class="sd">            ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        sort method +x,-x,+y,-y,+z,-z,species,sp list,alphabetical,periodical,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sort_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span>
            <span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="c1"># making individual string so it can work in for loop enumerate below</span>
            <span class="n">sort_method</span> <span class="o">=</span> <span class="p">[</span><span class="n">sort_method</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; not the same length of amount of species in ABCMolecule&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sort_method</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item not correct type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line (len(item)=1)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item position 1 is not one of type &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;None&#39;,None (len(item)=2)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item length &gt; 2&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; not correct types&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending is type list but sortmethod is not type list&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() length of ascending list not equivalent to length of sort method&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ascending</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending list[bool] not all bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending bool type not bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
                <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending argument is wrong&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>  <span class="c1"># for string</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">atoms</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; is not correct&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1">#if isinstance(item, str):</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
                <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span>
                        <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
                        <span class="kc">None</span>
                <span class="p">]:</span>
                    <span class="c1"># raise ValueError(&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list species index 1 is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;,&#39;None&#39;,None&quot;) # yapf: disable</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="n">item</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list species does not contain species&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;periodical&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.add_coords" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_coords</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">absorbent_reference</span><span class="p">,</span> <span class="n">surface_reference</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Add a new Molecule object to the current ABCMolecule object very precisely.</p>
<h6 id="molecule_lib.ABCMolecule.add_coords--parameters">Parameters</h6>
<p>molecule : ABCMolecule or XYZMolecule
    <em>description</em>
axis : "{0 or 'x', 1 or 'y', 2 or 'z'}"
    Placement of new molecule will be in direction of axis.
absorbent_reference : "{'Top' or 'Centroid' or 'Bottom' or 'Most postive Sp' or 'Most negative Sp' or CoordType}"
    <em>description</em>
surface_reference : "{'Top' or 'Centroid' or 'Bottom' or 'Most postive Sp' or 'Most negative Sp' or CoordType}"
    <em>description</em>
dist : float
    sign of float determines what direction the new molecule is placed.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.ABCMolecule.add_coords--returns">Returns</h6>
<p>ABCMolecule
    ABCMolecule with new atoms added.</p>
<h6 id="molecule_lib.ABCMolecule.add_coords--notes">Notes</h6>
<p>Need to add CoordType logic.
Need to add ABCMolecule logic.
NEED TO ADD absorbent/surface reference can of type coord also probably need coord protocol
NEED TO ADD LOGIC FOR CONVERTING TO DIFFERENT ATOM TYPES
operation happens in cartesian coordinates and then the new coords are converted back to positional
need to ensure operation only happens in a trigonal unit cell until i find the generic unitcell formula</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">molecule</span><span class="p">:</span> <span class="n">ABCMolecule</span> <span class="o">|</span> <span class="n">XYZMolecule</span><span class="p">,</span>
               <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
               <span class="n">absorbent_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ABCCoord</span><span class="p">,</span>
               <span class="n">surface_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ABCCoord</span><span class="p">,</span>
               <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
               <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a new Molecule object to the current ABCMolecule object very precisely.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    molecule : ABCMolecule or XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">        Placement of new molecule will be in direction of axis.</span>
<span class="sd">    absorbent_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">        _description_</span>
<span class="sd">    surface_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">        _description_</span>
<span class="sd">    dist : float</span>
<span class="sd">        sign of float determines what direction the new molecule is placed.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        ABCMolecule with new atoms added.</span>

<span class="sd">    Notes</span>
<span class="sd">    ------</span>
<span class="sd">    Need to add CoordType logic.</span>
<span class="sd">    Need to add ABCMolecule logic.</span>
<span class="sd">    NEED TO ADD absorbent/surface reference can of type coord also probably need coord protocol</span>
<span class="sd">    NEED TO ADD LOGIC FOR CONVERTING TO DIFFERENT ATOM TYPES</span>
<span class="sd">    operation happens in cartesian coordinates and then the new coords are converted back to positional</span>
<span class="sd">    need to ensure operation only happens in a trigonal unit cell until i find the generic unitcell formula</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.add_coords() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; or 1 or 2 or 3 &quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">match</span> <span class="n">axis</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">case</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">ABCMolecule</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">molecule</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
            <span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">XYZMolecule</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.add_coords() required argument &#39;molecule&#39; not correct type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="c1"># needed to not append to memory and return only changed object</span>
    <span class="n">combined_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="c1"># need convert bc operation happens in cartesian coords</span>
    <span class="n">sur_centroids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
    <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="n">sur_centroids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="n">x_import_centroid</span><span class="p">,</span> <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">(</span>
    <span class="p">)</span>
    <span class="n">abs_centroids</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">x_import_centroid</span><span class="p">,</span> <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span>
    <span class="p">]</span>
    <span class="n">x_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">y_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">z_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">abs_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_import_list</span><span class="p">,</span> <span class="n">y_import_list</span><span class="p">,</span> <span class="n">z_import_list</span><span class="p">)</span>
    <span class="n">atom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
    <span class="n">x_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">atom_list</span><span class="p">]</span>
    <span class="n">y_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">atom_list</span><span class="p">]</span>
    <span class="n">z_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">atom_list</span><span class="p">]</span>
    <span class="n">sur_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_curr_list</span><span class="p">,</span> <span class="n">y_curr_list</span><span class="p">,</span> <span class="n">z_curr_list</span><span class="p">)</span>
    <span class="c1"># finding absorbent values</span>
    <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
        <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
    <span class="k">elif</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
        <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
        <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if absorbent_reference == &quot;Bottom&quot;:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">abs_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">abs_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">abs_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="c1"># finding surface values now</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">surface_reference</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.add_coords() required argument &#39;surface_reference&#39; is not type str or ABCCoord.&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="n">sur_centroids</span>
    <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;(0.5,0.5,0.5)&quot;</span><span class="p">:</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="c1"># if surface_reference == ABSORBENT_OPTIONS[&#39;starting_surface_list&#39;][1]:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">sur_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span> <span class="ow">or</span> <span class="s2">&quot;Most negative&quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
        <span class="n">species</span> <span class="o">=</span> <span class="n">surface_reference</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span>
        <span class="k">if</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if &quot;Most negative&quot; in surface_reference:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">species_import_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">axis_int</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
            <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">species</span>
        <span class="p">]</span>
        <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">species_import_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># necessary for add atom</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># if surface_reference == &#39;origin&#39;</span>
    <span class="c1"># math for finding displacement distanceance</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span>
    <span class="c1"># print(f&#39;{sur_mod = }&#39;)</span>
    <span class="c1"># print(f&#39;{abs_mod = }&#39;)</span>
    <span class="n">x_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">z_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
            <span class="n">combined_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ABCCoord</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_mod</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span><span class="p">,</span>
                         <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y_mod</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">,</span>
                         <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">z_mod</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">combined_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ABCCoord</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span>
                         <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_mod</span><span class="p">,</span>
                         <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y_mod</span><span class="p">,</span>
                         <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">z_mod</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">combined_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">combined_atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.append" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">append</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="n">positional</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>To add coords to the current self.atoms attribute.</p>
<h6 id="molecule_lib.ABCMolecule.append--parameters">Parameters</h6>
<p>new_coords : ABCCoord or list[ABCCoord]
    List of new coords to add to new object.
positional : bool
    True if coords are positional coordinates. False if they are cartesian coordinates.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.ABCMolecule.append--returns">Returns</h6>
<p>ABCMolecule
    <em>description</em></p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
           <span class="n">new_coords</span><span class="p">:</span> <span class="n">ABCCoord</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">],</span>
           <span class="n">positional</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
           <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To add coords to the current self.atoms attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    new_coords : ABCCoord or list[ABCCoord]</span>
<span class="sd">        List of new coords to add to new object.</span>
<span class="sd">    positional : bool</span>
<span class="sd">        True if coords are positional coordinates. False if they are cartesian coordinates.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_coords</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_coords</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ABCCoord</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.__init__() index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> of atoms is not type ABCCoord; item = </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="n">positional</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
        <span class="n">converted_coords</span> <span class="o">=</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                       <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
                                       <span class="n">atoms</span><span class="o">=</span><span class="n">new_coords</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">atoms</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="p">[</span>
            <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ABCCoord</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                                       <span class="n">coord</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">converted_coords</span>
        <span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">positional</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
        <span class="n">converted_coords</span> <span class="o">=</span> <span class="n">new_coords</span>
        <span class="c1"># CONVERTING CARTESIAN TO POSITIONAL COORDS</span>
        <span class="p">[</span>
            <span class="n">new_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ABCCoord</span><span class="p">(</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">a</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">b</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()[</span><span class="mi">2</span><span class="p">],</span>
                <span class="p">))</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">converted_coords</span>
        <span class="p">]</span>
    <span class="n">new_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="n">new_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_coords</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">new_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.convert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">convert</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;trig&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Converts ABCMolecule to XYZMolecule.</p>
<h6 id="molecule_lib.ABCMolecule.convert--parameters">Parameters</h6>
<p>method : str, "{'general' or 'trig' or 'linalg'}" default 'trig'
    Which method you want to use for converting ABCMolecule positional coords to, cartesian coordinates.
        'general' is the general formula.
        'trig' looks most correct and is the default.
        'linalg' is an unfinished method using linear algebra concepts.</p>
<h6 id="molecule_lib.ABCMolecule.convert--returns">Returns</h6>
<p>ABCMolecule
    <em>description</em></p>
<h6 id="molecule_lib.ABCMolecule.convert--notes">Notes</h6>
<p>Maybe we can use Tristan's paid chatgpt for it to help me
    figure out the different methods and what is going on exactly.
Notes on different methods:
'linalg' is jerry's method that is unfinished
'general' is the wikipedia formula which is supposedly the general solution but something is wrong about it
'trig' is default and is what I believe is the correct method. Lowkey got it from chatgpt but it is correct.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;trig&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts ABCMolecule to XYZMolecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method : str, &quot;{&#39;general&#39; or &#39;trig&#39; or &#39;linalg&#39;}&quot; default &#39;trig&#39;</span>
<span class="sd">        Which method you want to use for converting ABCMolecule positional coords to, cartesian coordinates.</span>
<span class="sd">            &#39;general&#39; is the general formula.</span>
<span class="sd">            &#39;trig&#39; looks most correct and is the default.</span>
<span class="sd">            &#39;linalg&#39; is an unfinished method using linear algebra concepts.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Maybe we can use Tristan&#39;s paid chatgpt for it to help me</span>
<span class="sd">        figure out the different methods and what is going on exactly.</span>
<span class="sd">    Notes on different methods:</span>
<span class="sd">    &#39;linalg&#39; is jerry&#39;s method that is unfinished</span>
<span class="sd">    &#39;general&#39; is the wikipedia formula which is supposedly the general solution but something is wrong about it</span>
<span class="sd">    &#39;trig&#39; is default and is what I believe is the correct method. Lowkey got it from chatgpt but it is correct.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">,</span> <span class="s2">&quot;trig&quot;</span><span class="p">,</span> <span class="s2">&quot;linalg&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.convert() optional argument &#39;method&#39; is not &#39;general&#39;,&#39;trig&#39; or &#39;linalg&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;general&quot;</span><span class="p">:</span>
            <span class="c1"># ====================================</span>
            <span class="c1"># former code using wikipedia resource....</span>
            <span class="c1"># =====================================</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
            <span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getanglesrad</span><span class="p">()</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
                <span class="p">[</span>
                    <span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span>
                    <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span>
                              <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">),</span>
                    <span class="n">b</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">alp</span><span class="p">),</span>
                    <span class="mi">0</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="p">[</span><span class="n">a</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">),</span> <span class="n">c</span><span class="p">],</span>
            <span class="p">])</span>
            <span class="n">convert_atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
                    <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">a</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">b</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">c</span><span class="p">],</span>
                <span class="p">])</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">XYZCoord</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
            <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;trig&quot;</span><span class="p">:</span>
            <span class="c1"># ====================================</span>
            <span class="c1"># created using chatgpt as a resource.</span>
            <span class="c1"># quote &quot;correct&quot; method</span>
            <span class="c1"># =====================================</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
            <span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">getanglesrad</span><span class="p">()</span>
            <span class="n">convert_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">x_car</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span>
                <span class="n">y_car</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">/</span> <span class="n">sin</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">c</span>
                <span class="n">z_car</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>
                                 <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span>
                                 <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">*</span> <span class="n">atom</span><span class="o">.</span><span class="n">c</span>
                <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">x_car</span><span class="p">,</span> <span class="n">y_car</span><span class="p">,</span>
                                              <span class="n">z_car</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if method == &#39;linalg&#39;</span>
            <span class="c1"># ==================================</span>
            <span class="c1"># jerry&#39;s method not fully correct</span>
            <span class="c1"># ==================================</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_2</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_3</span>
            <span class="p">])</span>
            <span class="n">Coord_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">atom</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">atom</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
                           <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]))</span>
            <span class="n">transform_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">constant</span> <span class="o">*</span>
                                            <span class="p">(</span><span class="n">L</span> <span class="o">*</span> <span class="n">Coord_matrix</span><span class="p">))</span>
            <span class="n">convert_atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">transform_matrix</span><span class="p">):</span>
                <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">XYZCoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
            <span class="n">atoms</span><span class="o">=</span><span class="p">[</span>
                <span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
            <span class="p">],</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.delete" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Delete INDEXED atoms in ABCMolecule.</p>
<h6 id="molecule_lib.ABCMolecule.delete--parameters">Parameters</h6>
<p>index : MolIndex
    <em>description</em>
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.ABCMolecule.delete--returns">Returns</h6>
<p>ABCMolecule
    ABCMolecule with selected atoms deleted.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete INDEXED atoms in ABCMolecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : MolIndex</span>
<span class="sd">        _description_</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        ABCMolecule with selected atoms deleted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">saving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">del_ints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">del_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
    <span class="n">saving_atoms</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">del_ints</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">saving_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">saving_atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.freeze_atoms" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">freeze_atoms</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">freeze_indexed</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p><em>summary</em></p>
<h6 id="molecule_lib.ABCMolecule.freeze_atoms--parameters">Parameters</h6>
<p>index : MolIndex
    <em>description</em>
freeze_indexed : bool
    <em>description</em>
inplace : bool, optional
    <em>description</em>, by default False</p>
<h6 id="molecule_lib.ABCMolecule.freeze_atoms--returns">Returns</h6>
<p>ABCMolecule
    <em>description</em></p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">freeze_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span>
                 <span class="n">freeze_indexed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                 <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : MolIndex</span>
<span class="sd">        _description_</span>
<span class="sd">    freeze_indexed : bool</span>
<span class="sd">        _description_</span>
<span class="sd">    inplace : bool, optional</span>
<span class="sd">        _description_, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">indexed_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">false_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">true_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">indexed_mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">false_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">coord</span><span class="p">)</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="n">true_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">true_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">coord</span><span class="p">)</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="n">false_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">false_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">true_atoms</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">freeze_indexed</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>

    <span class="n">frozen_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">false_atoms</span><span class="p">:</span>
            <span class="n">frozen_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">true_atoms</span><span class="p">:</span>
            <span class="n">frozen_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.freeze_atoms() runtime error. coord not in false_atoms or true_atoms&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span> <span class="o">=</span> <span class="n">frozen_atoms</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">frozen_atoms</span><span class="o">=</span><span class="n">frozen_atoms</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.format" class="doc doc-heading">
          <code class="highlight language-python"><span class="nb">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns formatted text for textbox or filewrite.</p>
<h6 id="molecule_lib.ABCMolecule.format--parameters">Parameters</h6>
<p>endline : str, default " "
    Endline string for each file line.</p>
<h6 id="molecule_lib.ABCMolecule.format--returns">Returns</h6>
<p>list[str]
    list of strings for vasp format with endline str as last character in string.</p>
<h6 id="molecule_lib.ABCMolecule.format--notes">Notes</h6>
<p>Can replace text.append self.atoms with abcCoord.line()
need to add selective logic and information</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endline</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns formatted text for textbox or filewrite.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    endline : str, default &quot; &quot;</span>
<span class="sd">        Endline string for each file line.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[str]</span>
<span class="sd">        list of strings for vasp format with endline str as last character in string.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Can replace text.append self.atoms with abcCoord.line()</span>
<span class="sd">    need to add selective logic and information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">_format_species</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ele</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">_len</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">]</span>
    <span class="n">_format_amount</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ele</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">_len</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">]</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">constant</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_2</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_3</span>
    <span class="p">]:</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_format_species</span><span class="p">)</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_format_amount</span><span class="p">)</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span> <span class="o">!=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]]:</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Selective Dynamics </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Cartesian&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Direct&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span> <span class="o">!=</span> <span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]]:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Sa</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">Sa</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">Sa</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">La</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fa</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.get_centroid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_centroid</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns 3d centroid of ABCMolecule atoms.</p>
<h6 id="molecule_lib.ABCMolecule.get_centroid--returns">Returns</h6>
<p>tuple[float,float,float]
    Tuple of (x_centroid,y_centroid,z_centroid) in units Angstroms.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns 3d centroid of ABCMolecule atoms.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[float,float,float]</span>
<span class="sd">        Tuple of (x_centroid,y_centroid,z_centroid) in units Angstroms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">a</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">b</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">z_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">c</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">x_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
    <span class="n">y_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
    <span class="n">z_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x_centroid</span><span class="p">,</span> <span class="n">y_centroid</span><span class="p">,</span> <span class="n">z_centroid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.info" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">info</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Prints ABCMolecule current attribute information to terminal.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints ABCMolecule current attribute information to terminal.&quot;&quot;&quot;</span>
    <span class="n">species_key</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">x</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span>
    <span class="p">]</span>
    <span class="n">amount_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">sp</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">species_key</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">ele</span><span class="p">,</span> <span class="n">amt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">):</span>
        <span class="n">curr_value</span> <span class="o">=</span> <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span>
        <span class="n">new_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">curr_value</span><span class="p">)</span>
        <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_value</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type: ABCMolecule</span><span class="se">\n</span><span class="s2">filetype: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="se">\n</span><span class="s2">total atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="se">\n</span><span class="s2">species info: </span><span class="si">{</span><span class="n">amount_dict</span><span class="si">}</span><span class="se">\n</span><span class="s2">comment line: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">lattice constant: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">constant</span><span class="si">}</span><span class="se">\n</span><span class="s2">lattice matrix:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_1</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_2</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="o">.</span><span class="n">vector_3</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.manipulate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">manipulate</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Rotate or move only INDEXED atoms in ABCMolecule.</p>
<h6 id="molecule_lib.ABCMolecule.manipulate--parameters">Parameters</h6>
<p>index : MolIndex
    <em>description</em>
func : "{'move' or 'rotate'}"
    ABCMolecule method you want to execute on the indexed atoms.
inplace : bool, default False
    If True, perform operation in-place.
<em>args,</em>*kwargs
    Needed for the chosen function 'move' or 'rotate'.</p>
<h6 id="molecule_lib.ABCMolecule.manipulate--returns">Returns</h6>
<p>ABCMolecule or None
    ABCMolecule with all atoms moved or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">manipulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span>
               <span class="n">func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate or move only INDEXED atoms in ABCMolecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : MolIndex</span>
<span class="sd">        _description_</span>
<span class="sd">    func : &quot;{&#39;move&#39; or &#39;rotate&#39;}&quot;</span>
<span class="sd">        ABCMolecule method you want to execute on the indexed atoms.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>
<span class="sd">    *args,**kwargs</span>
<span class="sd">        Needed for the chosen function &#39;move&#39; or &#39;rotate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule or None</span>
<span class="sd">        ABCMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">moving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
            <span class="n">moving_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
    <span class="n">moving_mol</span> <span class="o">=</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                             <span class="n">atoms</span><span class="o">=</span><span class="n">moving_atoms</span><span class="p">,</span>
                             <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
        <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;rotate&quot;</span><span class="p">:</span>
        <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.manipulate() required argument &#39;func&#39; not &#39;move&#39; or &#39;rotate&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">new_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i_list</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">):</span>
        <span class="n">new_atoms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.move" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">move</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Move atoms in designated directions.</p>
<h6 id="molecule_lib.ABCMolecule.move--parameters">Parameters</h6>
<p>x : float, default 0.0
    Move coord in x direction by float amount.
y : float, default 0.0
    Move coord in y direction by float amount.
z : float, default 0.0
    Move coord in z direction by float amount.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.ABCMolecule.move--returns">Returns</h6>
<p>ABCMolecule or None
    ABCMolecule with all atoms moved or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
         <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
         <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
         <span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
         <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Move atoms in designated directions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float, default 0.0</span>
<span class="sd">        Move coord in x direction by float amount.</span>
<span class="sd">    y : float, default 0.0</span>
<span class="sd">        Move coord in y direction by float amount.</span>
<span class="sd">    z : float, default 0.0</span>
<span class="sd">        Move coord in z direction by float amount.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule or None</span>
<span class="sd">        ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;x&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;y&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;z&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.move() optional argument &#39;inplace&#39; is not a bool&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span>
        <span class="n">x_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">a</span>
        <span class="n">y_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">b</span>
        <span class="n">z_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">c</span>
        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ABCCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">sp</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">x_old</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">y_old</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z_old</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.printt" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">printt</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Prints save file text to terminal.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">printt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints save file text to terminal.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.rotate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">about_centroid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Rotate atoms about designated axis.</p>
<h6 id="molecule_lib.ABCMolecule.rotate--parameters">Parameters</h6>
<p>axis : "{0 or 'x', 1 or 'y', 2 or 'z'}"
    Parallel axis of rotation.
angle : float
    Angle of rotation.
unit : "deg" or "rad", default "deg"
    Unit of angle argument.
about_centroid : bool, default True
    If True, rotation occurs about the centroid.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.ABCMolecule.rotate--returns">Returns</h6>
<p>ABCMolecule or None
    ABCMolecule with all atoms moved or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
           <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
           <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
           <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;deg&quot;</span><span class="p">,</span>
           <span class="n">about_centroid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
           <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate atoms about designated axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">        Parallel axis of rotation.</span>
<span class="sd">    angle : float</span>
<span class="sd">        Angle of rotation.</span>
<span class="sd">    unit : &quot;deg&quot; or &quot;rad&quot;, default &quot;deg&quot;</span>
<span class="sd">        Unit of angle argument.</span>
<span class="sd">    about_centroid : bool, default True</span>
<span class="sd">        If True, rotation occurs about the centroid.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule or None</span>
<span class="sd">        ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rotate_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
    <span class="n">rotate_mol</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                      <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span>
                      <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
                      <span class="n">about_centroid</span><span class="o">=</span><span class="n">about_centroid</span><span class="p">,</span>
                      <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">convert_mol</span> <span class="o">=</span> <span class="n">rotate_mol</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">lattice_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
                                     <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">)</span>
    <span class="n">convert_mol</span><span class="o">.</span><span class="n">comment_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">convert_mol</span><span class="o">.</span><span class="n">atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">convert_mol</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.save" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Save ABCMolecule instance to given filename in vasp format in current working directory.</p>
<h6 id="molecule_lib.ABCMolecule.save--parameters">Parameters</h6>
<p>filename : str
    Name you want the saved file to be.</p>
<h6 id="molecule_lib.ABCMolecule.save--returns">Returns</h6>
<p>filename in current working directory.</p>
<h6 id="molecule_lib.ABCMolecule.save--notes">Notes</h6>
<p>Eventually add for other file types...</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save ABCMolecule instance to given filename in vasp format in current working directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        Name you want the saved file to be.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    filename in current working directory.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Eventually add for other file types...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="n">openfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.ABCMolecule.sort" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sort</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Sort the atoms by position, species, alphabetical or atomic number.</p>
<h6 id="molecule_lib.ABCMolecule.sort--parameters">Parameters</h6>
<p>sort_method : str | list[str] | list[list[str]]
    Method given by which the atoms will be sorted.
        - if sort_method is 'x' the atoms will be sorted by their x coordinate.
        - if sort_method is 'y' the atoms will be sorted by their y coordinate.
        - if sort_method is 'z' the atoms will be sorted by their z coordinate.
        - if sort_method is 'alphabetical' the atoms will be sorted in alphabetical order by their species.
        - if sort_method is 'periodical' the atoms will be sorted by their atomic number.
    You can also supply a list of lists with position 0 being species and position 1 being 'x','y','z', or None.
        This will sort the coordinates by species then by the method provided for each species,
        you can also add a list of bool for ascending values that will correspond to each species chosen method.
    You can also supply a list of species and it will be reordered to the given order.
ascending : bool or list of bool, default True
    Sort ascending vs. descending. Specify list for multiple sort orders (as described above). If this is a list of bools, must match the length of sort_method.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.ABCMolecule.sort--returns">Returns</h6>
<p>ABCMolecule or None
    ABCMolecule with all atoms moved or None if inplace=True.</p>
<h6 id="molecule_lib.ABCMolecule.sort--notes">Notes</h6>
<p>sort method +x,-x,+y,-y,+z,-z,species,sp list,alphabetical,periodical,</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
         <span class="n">sort_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
         <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
         <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort the atoms by position, species, alphabetical or atomic number.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sort_method : str | list[str] | list[list[str]]</span>
<span class="sd">        Method given by which the atoms will be sorted.</span>
<span class="sd">            - if sort_method is &#39;x&#39; the atoms will be sorted by their x coordinate.</span>
<span class="sd">            - if sort_method is &#39;y&#39; the atoms will be sorted by their y coordinate.</span>
<span class="sd">            - if sort_method is &#39;z&#39; the atoms will be sorted by their z coordinate.</span>
<span class="sd">            - if sort_method is &#39;alphabetical&#39; the atoms will be sorted in alphabetical order by their species.</span>
<span class="sd">            - if sort_method is &#39;periodical&#39; the atoms will be sorted by their atomic number.</span>
<span class="sd">        You can also supply a list of lists with position 0 being species and position 1 being &#39;x&#39;,&#39;y&#39;,&#39;z&#39;, or None.</span>
<span class="sd">            This will sort the coordinates by species then by the method provided for each species,</span>
<span class="sd">            you can also add a list of bool for ascending values that will correspond to each species chosen method.</span>
<span class="sd">        You can also supply a list of species and it will be reordered to the given order.</span>
<span class="sd">    ascending : bool or list of bool, default True</span>
<span class="sd">        Sort ascending vs. descending. Specify list for multiple sort orders (as described above). If this is a list of bools, must match the length of sort_method.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule or None</span>
<span class="sd">        ABCMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    sort method +x,-x,+y,-y,+z,-z,species,sp list,alphabetical,periodical,</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sort_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="c1"># making individual string so it can work in for loop enumerate below</span>
        <span class="n">sort_method</span> <span class="o">=</span> <span class="p">[</span><span class="n">sort_method</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; not the same length of amount of species in ABCMolecule&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sort_method</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item not correct type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line (len(item)=1)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item position 1 is not one of type &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;None&#39;,None (len(item)=2)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list item length &gt; 2&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; not correct types&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending is type list but sortmethod is not type list&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() length of ascending list not equivalent to length of sort method&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ascending</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending list[bool] not all bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending bool type not bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
            <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() ascending argument is wrong&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>  <span class="c1"># for string</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">atoms</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; is not correct&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1">#if isinstance(item, str):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
                    <span class="kc">None</span>
            <span class="p">]:</span>
                <span class="c1"># raise ValueError(&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list species index 1 is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;,&#39;None&#39;,None&quot;) # yapf: disable</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ABCMolecule.sort() required argument &#39;sort_method&#39; list species does not contain species&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;periodical&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unitcell</span><span class="p">,</span>
        <span class="n">positional</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div><h2 id="abc-private-functions">ABC Private Functions</h2>



<div class="doc doc-object doc-function">



<h3 id="molecule_lib._islatticematrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">_islatticematrix</span><span class="p">(</span><span class="n">lattice_list</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return True if lattice_list is .vasp file lattice matrix, False otherwise.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>lattice_list</code></b>
            (<code>(list of filelines.split())</code>)
        –
        <div class="doc-md-description">
          <p>Is a list of list of filelines
where each string in the file line seperated by a space is its own
element in the list. data_list[0] is the contains the first line
information of the file and data_list[-1] contains the last line
0 information of the file.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if lattice_list fufills .vasp file lattice matrix standards.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Notes</summary>
  <p>.vasp file lattice matrix:
    -lattice constant is a postive float number.
    -lattice matrix is a 3x3 float matrix.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_islatticematrix</span><span class="p">(</span><span class="n">lattice_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if lattice_list is .vasp file lattice matrix, False otherwise.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lattice_list : (list of filelines.split())</span>
<span class="sd">        Is a list of list of filelines</span>
<span class="sd">        where each string in the file line seperated by a space is its own</span>
<span class="sd">        element in the list. data_list[0] is the contains the first line</span>
<span class="sd">        information of the file and data_list[-1] contains the last line</span>
<span class="sd">        0 information of the file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if lattice_list fufills .vasp file lattice matrix standards.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    .vasp file lattice matrix:</span>
<span class="sd">        -lattice constant is a postive float number.</span>
<span class="sd">        -lattice matrix is a 3x3 float matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lattice_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1"># lattice constant should not be negative</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">lattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lattice_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">_isfloatstr</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">lattice_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib._is3byxfloatmatrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">_is3byxfloatmatrix</span><span class="p">(</span><span class="n">num_matrix</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return True if num_matrix is a 3 by x float matrix, False otherwise.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_is3byxfloatmatrix</span><span class="p">(</span><span class="n">num_matrix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if num_matrix is a 3 by x float matrix, False otherwise.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_matrix</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">_isfloatstr</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">num_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib._is6byxfloatselectivematrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">_is6byxfloatselectivematrix</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return True if sel_matrix is a 6 by x with first 3 data info is float matrix and next 3 is either 'F' or 'T' string, False otherwise.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_is6byxfloatselectivematrix</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if sel_matrix is a 6 by x with first 3 data info is float matrix and next 3 is either &#39;F&#39; or &#39;T&#39; string, False otherwise.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;F&quot;</span> <span class="ow">in</span> <span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;F&quot;</span> <span class="ow">in</span> <span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;F&quot;</span> <span class="ow">in</span> <span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">sel_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h2 id="abc-functions">ABC Functions</h2>



<div class="doc doc-object doc-function">



<h3 id="molecule_lib.isvasplist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">isvasplist</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return True if data list fufills .vasp file standards, False otherwise.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data_list</code></b>
            (<code>(list of filelines.split())</code>)
        –
        <div class="doc-md-description">
          <p>Is a list of list of filelines
where each string in the file line seperated by a space is its own
element in the list. data_list[0] is the contains the first line
information of the file and data_list[-1] contains the last line
0 information of the file.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>extralines</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>If True, if there are extra lines in the file, function returns False.
It is quote 'strict' on extra lines if True.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if data_list fufills .vasp file standards.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Notes</summary>
  <p>.vasp file standards:
    -there is a positive float value for lattice constant
    -there is a 3x3 float matrix for lattice matrix
    -there is correct species line
    -there is list of integers below species line
    -there is Selective Dynamics with dynamics info after coord info
    -there is Cartesian or Direct with correct coord matrix below</p>
</details>
          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isvasplist</span><span class="p">(</span><span class="n">data_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">extralines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if data list fufills .vasp file standards, False otherwise.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_list : (list of filelines.split())</span>
<span class="sd">        Is a list of list of filelines</span>
<span class="sd">        where each string in the file line seperated by a space is its own</span>
<span class="sd">        element in the list. data_list[0] is the contains the first line</span>
<span class="sd">        information of the file and data_list[-1] contains the last line</span>
<span class="sd">        0 information of the file.</span>
<span class="sd">    extralines: bool, default True</span>
<span class="sd">        If True, if there are extra lines in the file, function returns False.</span>
<span class="sd">        It is quote &#39;strict&#39; on extra lines if True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if data_list fufills .vasp file standards.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    .vasp file standards:</span>
<span class="sd">        -there is a positive float value for lattice constant</span>
<span class="sd">        -there is a 3x3 float matrix for lattice matrix</span>
<span class="sd">        -there is correct species line</span>
<span class="sd">        -there is list of integers below species line</span>
<span class="sd">        -there is Selective Dynamics with dynamics info after coord info</span>
<span class="sd">        -there is Cartesian or Direct with correct coord matrix below</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">_islatticematrix</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">ele</span> <span class="ow">in</span> <span class="n">ACCEPTED_ELEMENTS</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">tot_atom</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tot_atom</span> <span class="o">+</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">_is6byxfloatselectivematrix</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span> <span class="n">tot_atom</span> <span class="o">+</span> <span class="mi">9</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">num_top_lines</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">elif</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">_is3byxfloatmatrix</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span> <span class="n">tot_atom</span> <span class="o">+</span> <span class="mi">8</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">num_top_lines</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">extralines</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>  <span class="c1"># TODO!!!! IS THIS NEEDED??????????????????</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">tot_atom</span> <span class="o">+</span> \
                <span class="n">num_top_lines</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">tot_atom</span> <span class="o">*</span> \
            <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">num_top_lines</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.create_from_vasp_file_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">create_from_vasp_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>file_data</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>extralines</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p><em>description</em>, by default False</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_from_vasp_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">extralines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_data : list[list[str]]</span>
<span class="sd">        _description_</span>
<span class="sd">    extralines : bool, optional</span>
<span class="sd">        _description_, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isvasplist</span><span class="p">(</span><span class="n">data_list</span><span class="o">=</span><span class="n">file_data</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="n">extralines</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;parsererror, not vasplist&quot;</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]))]))</span>
    <span class="c1"># if &quot;S&quot; in file_data[7][0]:</span>
    <span class="c1">#         init_data = [file_data[i] for i in range(9, total + 9)]</span>
    <span class="c1">#         sp = [</span>
    <span class="c1">#             file_data[5][i]</span>
    <span class="c1">#             for i in range(len(file_data[5]))</span>
    <span class="c1">#             for _ in range(int(file_data[6][i]))</span>
    <span class="c1">#         ]</span>
    <span class="c1">#         selective = [</span>
    <span class="c1">#             SelectiveCoord(file_data[i][3],</span>
    <span class="c1">#                            file_data[i][4], file_data[i][5])</span>
    <span class="c1">#             for i in range(9, len(file_data))</span>
    <span class="c1">#         ]</span>
    <span class="c1">#     else:</span>
    <span class="n">init_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">total</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)]</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">i</span><span class="p">]))]</span>
    <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">positional</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">positional</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ABCCoord</span><span class="p">(</span>
            <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">init_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">init_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">init_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">unitcell</span><span class="o">=</span><span class="n">LatticeMatrix</span><span class="p">(</span>
            <span class="n">constant</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">vector_1</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span>
            <span class="n">vector_2</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span>
            <span class="n">vector_3</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span>
        <span class="p">),</span>
        <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span>
        <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;.vasp&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.read_vasp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">read_vasp</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Reads .vasp or POSCAR file and returns ABCMolecule instance.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>filepath</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p>Filename (if in current working directory)
or absolute path or os.path.join(os.getcwd(),'filename.xyz')</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>extralines</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>If True, if there are extra lines in the file, function will not return XYZMolecule instance.
It is quote 'strict' on extra lines if True.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Notes</summary>
  <p>Add selective logic, maybe add a bool to turn it on and off or add it if it doesn't have it.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_vasp</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extralines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads .vasp or POSCAR file and returns ABCMolecule instance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str</span>
<span class="sd">        Filename (if in current working directory)</span>
<span class="sd">        or absolute path or os.path.join(os.getcwd(),&#39;filename.xyz&#39;)</span>
<span class="sd">    extralines: bool, default True</span>
<span class="sd">        If True, if there are extra lines in the file, function will not return XYZMolecule instance.</span>
<span class="sd">        It is quote &#39;strict&#39; on extra lines if True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Add selective logic, maybe add a bool to turn it on and off or add it if it doesn&#39;t have it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath not a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath does not exist&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">openfile</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">create_from_vasp_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="o">=</span><span class="n">file_data</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="n">extralines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h2 id="xyz-no-unitcell-molecule-section">XYZ (No Unitcell) Molecule Section</h2>


<div class="doc doc-object doc-class">



<h3 id="molecule_lib.XYZCoord" class="doc doc-heading">
          <code>molecule_lib.XYZCoord</code>


</h3>


  <div class="doc doc-contents first">

  
      <p>Dataclass for atomic coordinates for use in XYZMolecule class.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>sp</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p>Species of atom.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>x</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>x coordinate position of atom.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>y</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>y coordinate position of atom.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>z</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>z coordinate position of atom.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.XYZCoord" href="#molecule_lib.XYZCoord">XYZCoord</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

            <details class="quote">
              <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">XYZCoord</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass for atomic coordinates for use in XYZMolecule class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sp : str</span>
<span class="sd">        Species of atom.</span>
<span class="sd">    x : float</span>
<span class="sd">        x coordinate position of atom.</span>
<span class="sd">    y : float</span>
<span class="sd">        y coordinate position of atom.</span>
<span class="sd">    z : float</span>
<span class="sd">        z coordinate position of atom.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZCoord</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZCoord.__init__() required postional argument &#39;sp&#39; is not an accepted species string&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZCoord.__init__() required positional argument &#39;x&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZCoord.__init__() required positional argument &#39;y&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZCoord.__init__() required positional argument &#39;z&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">sp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">z</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># when you are in kernel and run object with enter</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># by using str() or print()</span>
        <span class="c1"># also might need to create XYZCoord.line() method because this return was used in editor i think</span>
        <span class="c1"># return f&quot;{self.sp:&gt;4} {self.x:&gt;{Lc}.{Fc}f}{self.y:&gt;{Lc}.{Fc}f}{self.z:&gt;{Lc}.{Fc}f}&quot;</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;XYZCoord(sp=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">}</span><span class="s2">&#39;, x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, z=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># Notes</span>
        <span class="c1"># -----</span>
        <span class="c1"># needed for something... i think it was indexing but not 100% positive</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;XYZCoord.__getitem__() Index out of list.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZCoord.line" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">line</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1680</span>
<span class="normal">1681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="si">:</span><span class="s2">&gt;4</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lc</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fc</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="molecule_lib.XYZMolecule" class="doc doc-heading">
          <code>molecule_lib.XYZMolecule</code>


</h3>


  <div class="doc doc-contents first">

  
      <p>Class for xyz molecule object.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atoms</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="molecule_lib.XYZCoord" href="#molecule_lib.XYZCoord">XYZCoord</a>]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>comment_line</code></b>
            (<code>str</code>, default:
                <code>is &#34; &#34;</code>
)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>filetype</code></b>
            (<code>str</code>, default:
                <code>&#39;&#39;</code>
)
        –
        <div class="doc-md-description">
          <p><strong>description</strong></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.XYZMolecule" href="#molecule_lib.XYZMolecule">XYZMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

            <details class="quote">
              <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for xyz molecule object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atoms : list[XYZCoord]</span>
<span class="sd">        _description_</span>
<span class="sd">    comment_line : str, default is &quot; &quot;</span>
<span class="sd">        _description_</span>
<span class="sd">    filetype: str</span>
<span class="sd">        __description__</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">],</span> <span class="n">comment_line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.__init__() index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> of atoms is not type XYZCoord; item = </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">comment_line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_type</span> <span class="o">=</span> <span class="n">XYZCoord</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="s2">&quot;PL@C3H0LD3R&quot;</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">_</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">sp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        by using str() or print()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;XYZMolecule(atoms=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s2">, comment_line=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">XYZMolecule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">XYZMolecule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.__add__() can only add type XYZMolecule&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_coords</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        index type is int | str | list[int] | list[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
                <span class="k">if</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)]],</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.__getitem__() int is out of range of len(self.atoms) or is zero&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">index</span><span class="p">],</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
                    <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_molden_index</span><span class="p">(</span><span class="n">index</span><span class="p">)]],</span>
                    <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                    <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
                    <span class="k">if</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.__getitem__() int is out of range of len(self.atoms)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">ele</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">ele</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">item</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_molden_index</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span>
            <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.__getitem__() not valid index&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_molden_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule._get_molden_index() index type not correct&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">_n1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">_a1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
                <span class="n">_n1</span> <span class="o">+=</span> <span class="n">item</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_a1</span> <span class="o">+=</span> <span class="n">item</span>
        <span class="n">_n2</span> <span class="o">=</span> <span class="n">_n1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_n2</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule._get_molden_index() no # after&quot;</span><span class="p">)</span>
        <span class="n">_a2</span> <span class="o">=</span> <span class="n">_a1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="n">_a2</span> <span class="o">+</span> <span class="n">_n2</span><span class="p">:</span>
            <span class="n">_n3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_n2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_a2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule._get_molden_index() Sp not in self.speciesline&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">_a2</span><span class="p">)])</span> <span class="o">&gt;=</span> <span class="n">_n3</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">_a2</span><span class="p">][</span><span class="n">_n3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule._get_molden_index() # is too large or zero&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule._get_molden_index() Sp# out of order&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_item</span><span class="p">:</span> <span class="n">XYZCoord</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.__setitem__() index must be of type int or str&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_item</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">new_item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.__setitem__() Value assignment must be type XYZCoord&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="k">def</span> <span class="nf">add_coords</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">molecule</span><span class="p">:</span> <span class="n">XYZMolecule</span><span class="p">,</span>
        <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">absorbent_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">XYZCoord</span><span class="p">,</span>
        <span class="n">surface_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">XYZCoord</span><span class="p">,</span>
        <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new Molecule object to the current XYZMolecule object very precisely.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        molecule : XYZMolecule</span>
<span class="sd">            _description_</span>
<span class="sd">        axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">            Placement of new molecule will be in direction of axis.</span>
<span class="sd">        absorbent_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">            _description_</span>
<span class="sd">        surface_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">            _description_</span>
<span class="sd">        dist : float</span>
<span class="sd">            sign of float determines what direction the new molecule is placed.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule</span>
<span class="sd">            XYZMolecule with new atoms added.</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        Need to add CoordType logic.</span>
<span class="sd">        Need to add ABCMolecule logic.</span>
<span class="sd">        NEED TO ADD absorbent/surface reference can of type coord also probably need coord protocol</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.add_coords() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; or 1 or 2 or 3 &quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">match</span> <span class="n">axis</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">case</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">axis_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="c1"># needed to not append to memory and return only changed object</span>
        <span class="n">combined_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="n">sur_centroids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="n">sur_centroids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">x_import_centroid</span><span class="p">,</span> <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
        <span class="n">abs_centroids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_import_centroid</span><span class="p">,</span>
                         <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span><span class="p">]</span>
        <span class="n">x_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">y_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">z_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">abs_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_import_list</span><span class="p">,</span> <span class="n">y_import_list</span><span class="p">,</span> <span class="n">z_import_list</span><span class="p">)</span>
        <span class="n">x_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">y_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">z_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">sur_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_curr_list</span><span class="p">,</span> <span class="n">y_curr_list</span><span class="p">,</span> <span class="n">z_curr_list</span><span class="p">)</span>
        <span class="c1"># finding absorbent values</span>
        <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
            <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
        <span class="k">elif</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
            <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
            <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if absorbent_reference == &quot;Bottom&quot;:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
            <span class="n">abs_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">abs_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">abs_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="c1"># finding surface values now</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.add_coords() required argument &#39;surface_reference&#39; is not type str or XYZCoord.&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
            <span class="n">sur_mod</span> <span class="o">=</span> <span class="n">sur_centroids</span>
        <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;(0.5,0.5,0.5)&quot;</span><span class="p">:</span>
            <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
            <span class="c1"># if surface_reference == ABSORBENT_OPTIONS[&#39;starting_surface_list&#39;][1]:</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
            <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">sur_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span> <span class="ow">or</span> <span class="s2">&quot;Most negative&quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
            <span class="n">species</span> <span class="o">=</span> <span class="n">surface_reference</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span>
            <span class="k">if</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if &quot;Most negative&quot; in surface_reference:</span>
                <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
            <span class="n">species_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">axis_int</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
                                   <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>
            <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">species_import_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># necessary for add atom</span>
            <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># if surface_reference == &#39;origin&#39;</span>
        <span class="c1"># math for finding displacement distanceance</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="n">distance</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span>
        <span class="n">x_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">combined_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span>
                <span class="n">ele</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_mod</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y_mod</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">z_mod</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">combined_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">combined_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_coords</span><span class="p">:</span> <span class="n">XYZCoord</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;To add coords to the current self.atoms attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_coords : XYZCoord or list[XYZCoord]</span>
<span class="sd">            List of new coords to add to new object.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_coords</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_coords</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.__init__() index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> of atoms is not type XYZCoord; item = </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">new_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="n">new_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_coords</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">new_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lattice_matrix</span><span class="p">:</span> <span class="n">LatticeMatrix</span><span class="p">,</span> <span class="n">positional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts XYZMolecule instance to ABCMolecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lattice_matrix : LatticeMatrix</span>
<span class="sd">            Instance of LatticeMatrix dataclass needed for ABCMolecule class.</span>
<span class="sd">        positional : bool, default True</span>
<span class="sd">            If True, XYZ cartesian coordinates will convert to positional coordinates. If False, ABCMolecule will contain cartesian coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ABCMolecule</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">positional</span><span class="p">:</span>
            <span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="n">lattice_matrix</span><span class="o">.</span><span class="n">getanglesrad</span><span class="p">()</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lattice_matrix</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
            <span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span>
                    <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="p">((</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span>
                    <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">))))</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span>
                    <span class="p">(</span><span class="o">-</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span>
                    <span class="mi">1</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">]</span>
            <span class="n">convert_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">]])</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">ABCCoord</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
            <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
                <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
                <span class="n">unitcell</span><span class="o">=</span><span class="n">lattice_matrix</span><span class="p">,</span>
                <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
                <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
                <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
                <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">],</span>
                <span class="n">unitcell</span><span class="o">=</span><span class="n">lattice_matrix</span><span class="p">,</span>
                <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
                <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete INDEXED atoms in XYZMolecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : MolIndex</span>
<span class="sd">            _description_</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule or None</span>
<span class="sd">            XYZMolecule with selected atoms deleted or None if inplace=True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">saving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">del_ints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1"># not exactly sure why but good theres a small amount of type ignores for each molecule class</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore s</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">del_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
        <span class="n">saving_atoms</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">del_ints</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">saving_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">saving_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endline</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns formatted text for textbox or filewrite.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        endline : str, default &quot; &quot;</span>
<span class="sd">            Endline string for each file line.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[str]</span>
<span class="sd">            list of strings for xyz format with endline str as last character in string.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Can replace text.append self.atoms with XYZCoord.line()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
                <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sp</span><span class="si">:</span><span class="s2">2</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">text</span>
        <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;.turbomole&quot;</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;$coord&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
                <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="si">:</span><span class="s2"> &lt;8</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="s1">&#39;&#39;</span><span class="si">:</span><span class="s2"> &lt;4</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">2</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;$end&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.format() optional argument &#39;filetype&#39; is not &#39;.xyz&#39; or &#39;.turbomole&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="k">def</span> <span class="nf">get_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns 3d centroid of XYZMolecule atoms.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[float,float,float]</span>
<span class="sd">            Tuple of (x_centroid,y_centroid,z_centroid) in units Angstroms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">z_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">z</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
        <span class="n">x_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
        <span class="n">y_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
        <span class="n">z_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_centroid</span><span class="p">,</span> <span class="n">y_centroid</span><span class="p">,</span> <span class="n">z_centroid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints XYZMolecule current attribute information to terminal.&quot;&quot;&quot;</span>
        <span class="n">species_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">amount_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">sp</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">species_key</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">ele</span><span class="p">,</span> <span class="n">amt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">):</span>
            <span class="n">curr_value</span> <span class="o">=</span> <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">curr_value</span><span class="p">)</span>
            <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_value</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type: XYZMolecule</span><span class="se">\n</span><span class="s2">filetype: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="se">\n</span><span class="s2">total atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="se">\n</span><span class="s2">species info: </span><span class="si">{</span><span class="n">amount_dict</span><span class="si">}</span><span class="se">\n</span><span class="s2">comment line: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">manipulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotate or move only INDEXED atoms in XYZMolecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : MolIndex</span>
<span class="sd">            _description_</span>
<span class="sd">        func : &quot;{&#39;move&#39; or &#39;rotate&#39;}&quot;</span>
<span class="sd">            XYZMolecule method you want to execute on the indexed atoms.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>
<span class="sd">        *args,**kwargs</span>
<span class="sd">            Needed for the chosen function &#39;move&#39; or &#39;rotate&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule or None</span>
<span class="sd">            XYZMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">moving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
            <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="n">i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
                <span class="n">moving_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
        <span class="n">moving_mol</span> <span class="o">=</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">moving_atoms</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
            <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;rotate&quot;</span><span class="p">:</span>
            <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.manipulate() required argument &#39;func&#39; not &#39;move&#39; or &#39;rotate&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">new_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i_list</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">):</span>
            <span class="n">new_atoms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ele</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">new_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move ALL atoms in designated directions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float, default 0.0</span>
<span class="sd">            Move coord in x direction by float amount.</span>
<span class="sd">        y : float, default 0.0</span>
<span class="sd">            Move coord in y direction by float amount.</span>
<span class="sd">        z : float, default 0.0</span>
<span class="sd">            Move coord in z direction by float amount.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule or None</span>
<span class="sd">            XYZMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;x&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;y&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;z&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;inplace&#39; is not a bool&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span>
            <span class="n">x_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">x</span>
            <span class="n">y_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span>
            <span class="n">z_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">z</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">sp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_old</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_old</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z_old</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">printt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints save file text to terminal.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;deg&quot;</span><span class="p">,</span>
        <span class="n">about_centroid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotate ALL atoms about designated axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">            Parallel axis of rotation.</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle of rotation.</span>
<span class="sd">        unit : &quot;deg&quot; or &quot;rad&quot;, default &quot;deg&quot;</span>
<span class="sd">            Unit of angle argument.</span>
<span class="sd">        about_centroid : bool, default True</span>
<span class="sd">            If True, rotation occurs about the centroid.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule or None</span>
<span class="sd">            XYZMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; &quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.rotate() required argument &#39;angle&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="s2">&quot;rad&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.rotate() required argument &#39;unit&#39; is not &#39;deg&#39; or &#39;rad&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.rotate() optional argument &#39;inplace&#39; is not a bool&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;deg&quot;</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">*=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
        <span class="k">match</span> <span class="n">axis</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">y</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">x</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">z</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>

                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.rotate() required argument &#39;axis&#39; is not &#39;x&#39;,&#39;y&#39;, or &#39;z&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">about_centroid</span><span class="p">:</span>
            <span class="n">x_cent</span><span class="p">,</span> <span class="n">y_cent</span><span class="p">,</span> <span class="n">z_cent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_cent</span> <span class="o">=</span> <span class="n">y_cent</span> <span class="o">=</span> <span class="n">z_cent</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">rot_x</span><span class="p">,</span> <span class="n">rot_y</span><span class="p">,</span> <span class="n">rot_z</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_cent</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_cent</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">z_cent</span><span class="p">)</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">rot_x</span> <span class="o">+</span> <span class="n">x_cent</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">rot_y</span> <span class="o">+</span> <span class="n">y_cent</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">rot_z</span> <span class="o">+</span> <span class="n">z_cent</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save XYZMolecule instance to given filename in current working directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Name you want the saved file to be.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filename.xyz in current working directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.xyz&quot;</span><span class="p">,</span><span class="s2">&quot;.turbomole&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.save() optional argument &#39;filetype&#39; is not &#39;.xyz&#39; or &#39;.turbomole&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">):</span>
                <span class="n">openfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sort_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the atoms in Molecule instance by position, species, alphabetical or atomic number.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sort_method : str | list[str] | list[list[str]]</span>
<span class="sd">            Method given by which the atoms will be sorted.</span>
<span class="sd">                - if sort_method is &#39;x&#39; the atoms will be sorted by their x coordinate.</span>
<span class="sd">                - if sort_method is &#39;y&#39; the atoms will be sorted by their y coordinate.</span>
<span class="sd">                - if sort_method is &#39;z&#39; the atoms will be sorted by their z coordinate.</span>
<span class="sd">                - if sort_method is &#39;alphabetical&#39; the atoms will be sorted in alphabetical order by their species.</span>
<span class="sd">                - if sort_method is &#39;periodical&#39; the atoms will be sorted by their atomic number.</span>
<span class="sd">            You can also supply a list of lists with position 0 being species and position 1 being &#39;x&#39;,&#39;y&#39;,&#39;z&#39;, or None.</span>
<span class="sd">                This will sort the coordinates by species then by the method provided for each species,</span>
<span class="sd">                you can also add a list of bool for ascending values that will correspond to each species chosen method.</span>
<span class="sd">            You can also supply a list of species and it will be reordered to the given order.</span>
<span class="sd">        ascending : bool or list of bool, default True</span>
<span class="sd">            Sort ascending vs. descending. Specify list for multiple sort orders (as described above). If this is a list of bools, must match the length of sort_method.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, perform operation in-place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        XYZMolecule or None</span>
<span class="sd">            XYZMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        sort method +x,-x,+y,-y,+z,-z,species,sp list,alphabetical,periodical,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sort_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="c1"># making individual string so it can work in for loop enumerate below</span>
            <span class="n">sort_method</span> <span class="o">=</span> <span class="p">[</span><span class="n">sort_method</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; not the same length of amount of species in XYZMolecule&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sort_method</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item not correct type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line (len(item)=1)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item position 1 is not one of type &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;None&#39;,None (len(item)=2)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item length &gt; 2&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; not correct types&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending is type list but sortmethod is not type list&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() length of ascending list not equivalent to length of sort method&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ascending</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending list[bool] not all bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending bool type not bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
                <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending argument is wrong&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>  <span class="c1"># for string</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">atoms</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; is not correct&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1">#if isinstance(item, str):</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
                <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                    <span class="c1"># raise ValueError(&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list species index 1 is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;,&#39;None&#39;,None&quot;) # yapf: disable</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="n">item</span>
                    <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list species does not contain species&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;periodical&quot;</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.add_coords" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_coords</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">absorbent_reference</span><span class="p">,</span> <span class="n">surface_reference</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Add a new Molecule object to the current XYZMolecule object very precisely.</p>
<h6 id="molecule_lib.XYZMolecule.add_coords--parameters">Parameters</h6>
<p>molecule : XYZMolecule
    <em>description</em>
axis : "{0 or 'x', 1 or 'y', 2 or 'z'}"
    Placement of new molecule will be in direction of axis.
absorbent_reference : "{'Top' or 'Centroid' or 'Bottom' or 'Most postive Sp' or 'Most negative Sp' or CoordType}"
    <em>description</em>
surface_reference : "{'Top' or 'Centroid' or 'Bottom' or 'Most postive Sp' or 'Most negative Sp' or CoordType}"
    <em>description</em>
dist : float
    sign of float determines what direction the new molecule is placed.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.XYZMolecule.add_coords--returns">Returns</h6>
<p>XYZMolecule
    XYZMolecule with new atoms added.</p>
<h6 id="molecule_lib.XYZMolecule.add_coords--notes">Notes</h6>
<p>Need to add CoordType logic.
Need to add ABCMolecule logic.
NEED TO ADD absorbent/surface reference can of type coord also probably need coord protocol</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_coords</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">molecule</span><span class="p">:</span> <span class="n">XYZMolecule</span><span class="p">,</span>
    <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">absorbent_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">XYZCoord</span><span class="p">,</span>
    <span class="n">surface_reference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">XYZCoord</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a new Molecule object to the current XYZMolecule object very precisely.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    molecule : XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">        Placement of new molecule will be in direction of axis.</span>
<span class="sd">    absorbent_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">        _description_</span>
<span class="sd">    surface_reference : &quot;{&#39;Top&#39; or &#39;Centroid&#39; or &#39;Bottom&#39; or &#39;Most postive Sp&#39; or &#39;Most negative Sp&#39; or CoordType}&quot;</span>
<span class="sd">        _description_</span>
<span class="sd">    dist : float</span>
<span class="sd">        sign of float determines what direction the new molecule is placed.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule</span>
<span class="sd">        XYZMolecule with new atoms added.</span>

<span class="sd">    Notes</span>
<span class="sd">    ------</span>
<span class="sd">    Need to add CoordType logic.</span>
<span class="sd">    Need to add ABCMolecule logic.</span>
<span class="sd">    NEED TO ADD absorbent/surface reference can of type coord also probably need coord protocol</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.add_coords() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; or 1 or 2 or 3 &quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">match</span> <span class="n">axis</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">case</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="n">axis_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="c1"># needed to not append to memory and return only changed object</span>
    <span class="n">combined_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="n">sur_centroids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
    <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="n">sur_centroids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sur_centroids</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="n">x_import_centroid</span><span class="p">,</span> <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
    <span class="n">abs_centroids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_import_centroid</span><span class="p">,</span>
                     <span class="n">y_import_centroid</span><span class="p">,</span> <span class="n">z_import_centroid</span><span class="p">]</span>
    <span class="n">x_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">y_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">z_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">abs_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_import_list</span><span class="p">,</span> <span class="n">y_import_list</span><span class="p">,</span> <span class="n">z_import_list</span><span class="p">)</span>
    <span class="n">x_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">y_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">z_curr_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">sur_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_curr_list</span><span class="p">,</span> <span class="n">y_curr_list</span><span class="p">,</span> <span class="n">z_curr_list</span><span class="p">)</span>
    <span class="c1"># finding absorbent values</span>
    <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
        <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
    <span class="k">elif</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
        <span class="n">abs_mod</span> <span class="o">=</span> <span class="n">abs_centroids</span>
        <span class="k">if</span> <span class="n">absorbent_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if absorbent_reference == &quot;Bottom&quot;:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">abs_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">abs_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">abs_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="c1"># finding surface values now</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.add_coords() required argument &#39;surface_reference&#39; is not type str or XYZCoord.&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface_reference</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Centroid&quot;</span><span class="p">:</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="n">sur_centroids</span>
    <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;(0.5,0.5,0.5)&quot;</span><span class="p">:</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span> <span class="ow">or</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Bottom&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">surface_reference</span> <span class="o">==</span> <span class="s2">&quot;Top&quot;</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="c1"># if surface_reference == ABSORBENT_OPTIONS[&#39;starting_surface_list&#39;][1]:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">sur_lists</span><span class="p">[</span><span class="n">axis_int</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span> <span class="ow">or</span> <span class="s2">&quot;Most negative&quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
        <span class="n">species</span> <span class="o">=</span> <span class="n">surface_reference</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span>
        <span class="k">if</span> <span class="s2">&quot;Most positive &quot;</span> <span class="ow">in</span> <span class="n">surface_reference</span><span class="p">:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if &quot;Most negative&quot; in surface_reference:</span>
            <span class="n">sort_func</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">species_import_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">axis_int</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
                               <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">species</span><span class="p">]</span>
        <span class="n">sur_mod</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_func</span><span class="p">(</span><span class="n">species_import_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># necessary for add atom</span>
        <span class="n">sur_mod</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># if surface_reference == &#39;origin&#39;</span>
    <span class="c1"># math for finding displacement distanceance</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">axis_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span>
    <span class="n">x_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">z_mod</span> <span class="o">=</span> <span class="n">sur_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">abs_mod</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">distance</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">combined_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">ele</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_mod</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y_mod</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">ele</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">z_mod</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">combined_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">combined_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.append" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">append</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>To add coords to the current self.atoms attribute.</p>
<h6 id="molecule_lib.XYZMolecule.append--parameters">Parameters</h6>
<p>new_coords : XYZCoord or list[XYZCoord]
    List of new coords to add to new object.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.XYZMolecule.append--returns">Returns</h6>
<p>XYZMolecule
    <em>description</em></p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_coords</span><span class="p">:</span> <span class="n">XYZCoord</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To add coords to the current self.atoms attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    new_coords : XYZCoord or list[XYZCoord]</span>
<span class="sd">        List of new coords to add to new object.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_coords</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_coords</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">XYZCoord</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.__init__() index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> of atoms is not type XYZCoord; item = </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">new_atoms</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="n">new_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_coords</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">new_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.convert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">convert</span><span class="p">(</span><span class="n">lattice_matrix</span><span class="p">,</span> <span class="n">positional</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Converts XYZMolecule instance to ABCMolecule.</p>
<h6 id="molecule_lib.XYZMolecule.convert--parameters">Parameters</h6>
<p>lattice_matrix : LatticeMatrix
    Instance of LatticeMatrix dataclass needed for ABCMolecule class.
positional : bool, default True
    If True, XYZ cartesian coordinates will convert to positional coordinates. If False, ABCMolecule will contain cartesian coordinates.</p>
<h6 id="molecule_lib.XYZMolecule.convert--returns">Returns</h6>
<p>ABCMolecule
    <em>description</em></p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lattice_matrix</span><span class="p">:</span> <span class="n">LatticeMatrix</span><span class="p">,</span> <span class="n">positional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts XYZMolecule instance to ABCMolecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lattice_matrix : LatticeMatrix</span>
<span class="sd">        Instance of LatticeMatrix dataclass needed for ABCMolecule class.</span>
<span class="sd">    positional : bool, default True</span>
<span class="sd">        If True, XYZ cartesian coordinates will convert to positional coordinates. If False, ABCMolecule will contain cartesian coordinates.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">positional</span><span class="p">:</span>
        <span class="n">alp</span><span class="p">,</span> <span class="n">bet</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="n">lattice_matrix</span><span class="o">.</span><span class="n">getanglesrad</span><span class="p">()</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lattice_matrix</span><span class="o">.</span><span class="n">getabc</span><span class="p">()</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">((</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">))))</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">cot</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">-</span> <span class="n">csc</span><span class="p">(</span><span class="n">alp</span><span class="p">)</span> <span class="o">*</span> <span class="n">csc</span><span class="p">(</span><span class="n">bet</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gam</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="p">(</span><span class="o">-</span><span class="n">cot</span><span class="p">(</span><span class="n">alp</span><span class="p">))</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span>
                <span class="mi">1</span> <span class="o">/</span> <span class="n">c</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">]</span>
        <span class="n">convert_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">atom</span><span class="o">.</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">z</span><span class="p">]])</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">convert_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ABCCoord</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="n">convert_atoms</span><span class="p">,</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="n">lattice_matrix</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span>
            <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span>
            <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">],</span>
            <span class="n">unitcell</span><span class="o">=</span><span class="n">lattice_matrix</span><span class="p">,</span>
            <span class="n">positional</span><span class="o">=</span><span class="n">positional</span><span class="p">,</span>
            <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.delete" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Delete INDEXED atoms in XYZMolecule.</p>
<h6 id="molecule_lib.XYZMolecule.delete--parameters">Parameters</h6>
<p>index : MolIndex
    <em>description</em>
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.XYZMolecule.delete--returns">Returns</h6>
<p>XYZMolecule or None
    XYZMolecule with selected atoms deleted or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete INDEXED atoms in XYZMolecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : MolIndex</span>
<span class="sd">        _description_</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule or None</span>
<span class="sd">        XYZMolecule with selected atoms deleted or None if inplace=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">saving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">del_ints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="c1"># not exactly sure why but good theres a small amount of type ignores for each molecule class</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore s</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">del_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
    <span class="n">saving_atoms</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">del_ints</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">saving_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">saving_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.format" class="doc doc-heading">
          <code class="highlight language-python"><span class="nb">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;.xyz&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns formatted text for textbox or filewrite.</p>
<h6 id="molecule_lib.XYZMolecule.format--parameters">Parameters</h6>
<p>endline : str, default " "
    Endline string for each file line.</p>
<h6 id="molecule_lib.XYZMolecule.format--returns">Returns</h6>
<p>list[str]
    list of strings for xyz format with endline str as last character in string.</p>
<h6 id="molecule_lib.XYZMolecule.format--notes">Notes</h6>
<p>Can replace text.append self.atoms with XYZCoord.line()</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endline</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns formatted text for textbox or filewrite.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    endline : str, default &quot; &quot;</span>
<span class="sd">        Endline string for each file line.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[str]</span>
<span class="sd">        list of strings for xyz format with endline str as last character in string.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Can replace text.append self.atoms with XYZCoord.line()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">:</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sp</span><span class="si">:</span><span class="s2">2</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>
    <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;.turbomole&quot;</span><span class="p">:</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;$coord&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="si">:</span><span class="s2"> &lt;8</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">Lx</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">Fx</span><span class="si">}</span><span class="s2">f</span><span class="si">}{</span><span class="s1">&#39;&#39;</span><span class="si">:</span><span class="s2"> &lt;4</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">2</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;$end&quot;</span> <span class="o">+</span> <span class="n">endline</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.format() optional argument &#39;filetype&#39; is not &#39;.xyz&#39; or &#39;.turbomole&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.get_centroid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_centroid</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Returns 3d centroid of XYZMolecule atoms.</p>
<h6 id="molecule_lib.XYZMolecule.get_centroid--returns">Returns</h6>
<p>tuple[float,float,float]
    Tuple of (x_centroid,y_centroid,z_centroid) in units Angstroms.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns 3d centroid of XYZMolecule atoms.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[float,float,float]</span>
<span class="sd">        Tuple of (x_centroid,y_centroid,z_centroid) in units Angstroms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">z_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">z</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">x_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
    <span class="n">y_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_list</span><span class="p">)</span>
    <span class="n">z_centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x_centroid</span><span class="p">,</span> <span class="n">y_centroid</span><span class="p">,</span> <span class="n">z_centroid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.info" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">info</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Prints XYZMolecule current attribute information to terminal.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints XYZMolecule current attribute information to terminal.&quot;&quot;&quot;</span>
    <span class="n">species_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">amount_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">sp</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">species_key</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">ele</span><span class="p">,</span> <span class="n">amt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_amount</span><span class="p">):</span>
        <span class="n">curr_value</span> <span class="o">=</span> <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span>
        <span class="n">new_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">curr_value</span><span class="p">)</span>
        <span class="n">amount_dict</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_value</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type: XYZMolecule</span><span class="se">\n</span><span class="s2">filetype: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="se">\n</span><span class="s2">total atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="si">}</span><span class="se">\n</span><span class="s2">species info: </span><span class="si">{</span><span class="n">amount_dict</span><span class="si">}</span><span class="se">\n</span><span class="s2">comment line: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.manipulate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">manipulate</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Rotate or move only INDEXED atoms in XYZMolecule.</p>
<h6 id="molecule_lib.XYZMolecule.manipulate--parameters">Parameters</h6>
<p>index : MolIndex
    <em>description</em>
func : "{'move' or 'rotate'}"
    XYZMolecule method you want to execute on the indexed atoms.
inplace : bool, default False
    If True, perform operation in-place.
<em>args,</em>*kwargs
    Needed for the chosen function 'move' or 'rotate'.</p>
<h6 id="molecule_lib.XYZMolecule.manipulate--returns">Returns</h6>
<p>XYZMolecule or None
    XYZMolecule with all atoms moved or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">manipulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate or move only INDEXED atoms in XYZMolecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : MolIndex</span>
<span class="sd">        _description_</span>
<span class="sd">    func : &quot;{&#39;move&#39; or &#39;rotate&#39;}&quot;</span>
<span class="sd">        XYZMolecule method you want to execute on the indexed atoms.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>
<span class="sd">    *args,**kwargs</span>
<span class="sd">        Needed for the chosen function &#39;move&#39; or &#39;rotate&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule or None</span>
<span class="sd">        XYZMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">moving_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
            <span class="n">moving_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
    <span class="n">moving_mol</span> <span class="o">=</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">moving_atoms</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
        <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="s2">&quot;rotate&quot;</span><span class="p">:</span>
        <span class="n">new_mol</span> <span class="o">=</span> <span class="n">moving_mol</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.manipulate() required argument &#39;func&#39; not &#39;move&#39; or &#39;rotate&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">new_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i_list</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">):</span>
        <span class="n">new_atoms</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ele</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">new_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">new_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.move" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">move</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Move ALL atoms in designated directions.</p>
<h6 id="molecule_lib.XYZMolecule.move--parameters">Parameters</h6>
<p>x : float, default 0.0
    Move coord in x direction by float amount.
y : float, default 0.0
    Move coord in y direction by float amount.
z : float, default 0.0
    Move coord in z direction by float amount.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.XYZMolecule.move--returns">Returns</h6>
<p>XYZMolecule or None
    XYZMolecule with all atoms moved or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Move ALL atoms in designated directions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float, default 0.0</span>
<span class="sd">        Move coord in x direction by float amount.</span>
<span class="sd">    y : float, default 0.0</span>
<span class="sd">        Move coord in y direction by float amount.</span>
<span class="sd">    z : float, default 0.0</span>
<span class="sd">        Move coord in z direction by float amount.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule or None</span>
<span class="sd">        XYZMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;x&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;y&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;z&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.move() optional argument &#39;inplace&#39; is not a bool&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">sp</span>
        <span class="n">x_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">x</span>
        <span class="n">y_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span>
        <span class="n">z_old</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">z</span>
        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">sp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_old</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_old</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z_old</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.printt" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">printt</span><span class="p">()</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Prints save file text to terminal.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">printt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints save file text to terminal.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.rotate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">about_centroid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Rotate ALL atoms about designated axis.</p>
<h6 id="molecule_lib.XYZMolecule.rotate--parameters">Parameters</h6>
<p>axis : "{0 or 'x', 1 or 'y', 2 or 'z'}"
    Parallel axis of rotation.
angle : float
    Angle of rotation.
unit : "deg" or "rad", default "deg"
    Unit of angle argument.
about_centroid : bool, default True
    If True, rotation occurs about the centroid.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.XYZMolecule.rotate--returns">Returns</h6>
<p>XYZMolecule or None
    XYZMolecule with all atoms moved or None if inplace=True.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;deg&quot;</span><span class="p">,</span>
    <span class="n">about_centroid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotate ALL atoms about designated axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : &quot;{0 or &#39;x&#39;, 1 or &#39;y&#39;, 2 or &#39;z&#39;}&quot;</span>
<span class="sd">        Parallel axis of rotation.</span>
<span class="sd">    angle : float</span>
<span class="sd">        Angle of rotation.</span>
<span class="sd">    unit : &quot;deg&quot; or &quot;rad&quot;, default &quot;deg&quot;</span>
<span class="sd">        Unit of angle argument.</span>
<span class="sd">    about_centroid : bool, default True</span>
<span class="sd">        If True, rotation occurs about the centroid.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule or None</span>
<span class="sd">        XYZMolecule with all atoms moved or None if inplace=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.move() required argument &#39;angle&#39; is not &#39;x&#39; or &#39;y&#39; or &#39;z&#39; &quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.rotate() required argument &#39;angle&#39; is not a number&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="n">unit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="s2">&quot;rad&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZMolecule.rotate() required argument &#39;unit&#39; is not &#39;deg&#39; or &#39;rad&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.rotate() optional argument &#39;inplace&#39; is not a bool&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;deg&quot;</span><span class="p">:</span>
        <span class="n">angle</span> <span class="o">*=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
    <span class="k">match</span> <span class="n">axis</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">y</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">x</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">z</span>

        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.rotate() required argument &#39;axis&#39; is not &#39;x&#39;,&#39;y&#39;, or &#39;z&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>

    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">about_centroid</span><span class="p">:</span>
        <span class="n">x_cent</span><span class="p">,</span> <span class="n">y_cent</span><span class="p">,</span> <span class="n">z_cent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_centroid</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_cent</span> <span class="o">=</span> <span class="n">y_cent</span> <span class="o">=</span> <span class="n">z_cent</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">rot_x</span><span class="p">,</span> <span class="n">rot_y</span><span class="p">,</span> <span class="n">rot_z</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_cent</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_cent</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">z_cent</span><span class="p">)</span>
        <span class="n">return_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">rot_x</span> <span class="o">+</span> <span class="n">x_cent</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">rot_y</span> <span class="o">+</span> <span class="n">y_cent</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">rot_z</span> <span class="o">+</span> <span class="n">z_cent</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.save" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;.xyz&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Save XYZMolecule instance to given filename in current working directory.</p>
<h6 id="molecule_lib.XYZMolecule.save--parameters">Parameters</h6>
<p>filename : str
    Name you want the saved file to be.</p>
<h6 id="molecule_lib.XYZMolecule.save--returns">Returns</h6>
<p>filename.xyz in current working directory.</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save XYZMolecule instance to given filename in current working directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        Name you want the saved file to be.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    filename.xyz in current working directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filetype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.xyz&quot;</span><span class="p">,</span><span class="s2">&quot;.turbomole&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.save() optional argument &#39;filetype&#39; is not &#39;.xyz&#39; or &#39;.turbomole&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">):</span>
            <span class="n">openfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="molecule_lib.XYZMolecule.sort" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sort</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Sort the atoms in Molecule instance by position, species, alphabetical or atomic number.</p>
<h6 id="molecule_lib.XYZMolecule.sort--parameters">Parameters</h6>
<p>sort_method : str | list[str] | list[list[str]]
    Method given by which the atoms will be sorted.
        - if sort_method is 'x' the atoms will be sorted by their x coordinate.
        - if sort_method is 'y' the atoms will be sorted by their y coordinate.
        - if sort_method is 'z' the atoms will be sorted by their z coordinate.
        - if sort_method is 'alphabetical' the atoms will be sorted in alphabetical order by their species.
        - if sort_method is 'periodical' the atoms will be sorted by their atomic number.
    You can also supply a list of lists with position 0 being species and position 1 being 'x','y','z', or None.
        This will sort the coordinates by species then by the method provided for each species,
        you can also add a list of bool for ascending values that will correspond to each species chosen method.
    You can also supply a list of species and it will be reordered to the given order.
ascending : bool or list of bool, default True
    Sort ascending vs. descending. Specify list for multiple sort orders (as described above). If this is a list of bools, must match the length of sort_method.
inplace : bool, default False
    If True, perform operation in-place.</p>
<h6 id="molecule_lib.XYZMolecule.sort--returns">Returns</h6>
<p>XYZMolecule or None
    XYZMolecule with all atoms moved or None if inplace=True.</p>
<h6 id="molecule_lib.XYZMolecule.sort--notes">Notes</h6>
<p>sort method +x,-x,+y,-y,+z,-z,species,sp list,alphabetical,periodical,</p>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sort_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort the atoms in Molecule instance by position, species, alphabetical or atomic number.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sort_method : str | list[str] | list[list[str]]</span>
<span class="sd">        Method given by which the atoms will be sorted.</span>
<span class="sd">            - if sort_method is &#39;x&#39; the atoms will be sorted by their x coordinate.</span>
<span class="sd">            - if sort_method is &#39;y&#39; the atoms will be sorted by their y coordinate.</span>
<span class="sd">            - if sort_method is &#39;z&#39; the atoms will be sorted by their z coordinate.</span>
<span class="sd">            - if sort_method is &#39;alphabetical&#39; the atoms will be sorted in alphabetical order by their species.</span>
<span class="sd">            - if sort_method is &#39;periodical&#39; the atoms will be sorted by their atomic number.</span>
<span class="sd">        You can also supply a list of lists with position 0 being species and position 1 being &#39;x&#39;,&#39;y&#39;,&#39;z&#39;, or None.</span>
<span class="sd">            This will sort the coordinates by species then by the method provided for each species,</span>
<span class="sd">            you can also add a list of bool for ascending values that will correspond to each species chosen method.</span>
<span class="sd">        You can also supply a list of species and it will be reordered to the given order.</span>
<span class="sd">    ascending : bool or list of bool, default True</span>
<span class="sd">        Sort ascending vs. descending. Specify list for multiple sort orders (as described above). If this is a list of bools, must match the length of sort_method.</span>
<span class="sd">    inplace : bool, default False</span>
<span class="sd">        If True, perform operation in-place.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule or None</span>
<span class="sd">        XYZMolecule with all atoms moved or None if inplace=True.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    sort method +x,-x,+y,-y,+z,-z,species,sp list,alphabetical,periodical,</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sort_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="c1"># making individual string so it can work in for loop enumerate below</span>
        <span class="n">sort_method</span> <span class="o">=</span> <span class="p">[</span><span class="n">sort_method</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; not the same length of amount of species in XYZMolecule&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sort_method</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item not correct type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line (len(item)=1)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item position 0 not species in self.species_line&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item position 1 is not one of type &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;None&#39;,None (len(item)=2)&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list item length &gt; 2&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; not correct types&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sort_method</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending is type list but sortmethod is not type list&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() length of ascending list not equivalent to length of sort method&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ascending</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending list[bool] not all bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending bool type not bool type&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ascending</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sort_method</span><span class="p">):</span>
            <span class="n">reverse_bool</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">ascending</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() ascending argument is wrong&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>  <span class="c1"># for string</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">atoms</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; is not correct&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#if isinstance(item, str):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_line</span><span class="p">:</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">,</span> <span class="s2">&quot;periodical&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
                <span class="c1"># raise ValueError(&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list species index 1 is not one of &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;alphabetical&#39;,&#39;periodical&#39;,&#39;None&#39;,None&quot;) # yapf: disable</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">tobesorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;XYZMolecule.sort() required argument &#39;sort_method&#39; list species does not contain species&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;periodical&quot;</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_bool</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tobesorted</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">return_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">return_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div><h2 id="xyz-functions">XYZ Functions</h2>



<div class="doc doc-object doc-function">



<h3 id="molecule_lib.isturbomolelist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">isturbomolelist</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data_list</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>extralines</code></b>
            (<code>bool</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em>, by default False</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isturbomolelist</span><span class="p">(</span><span class="n">data_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_list : list[list[str]]</span>
<span class="sd">        _description_</span>
<span class="sd">    extralines : bool, optional</span>
<span class="sd">        _description_, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ACCEPTED_ELEMENTS_lower_case</span> <span class="o">=</span> <span class="p">[</span><span class="n">ele</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ACCEPTED_ELEMENTS</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;$coord&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">[</span><span class="s2">&quot;$user-defined bonds&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="n">final_atom_index</span> <span class="o">=</span> <span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;$user-defined bonds&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="p">[</span><span class="s2">&quot;$end&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="n">final_atom_index</span> <span class="o">=</span> <span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;$end&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">final_atom_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
        <span class="ow">and</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_ELEMENTS_lower_case</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.create_from_turbomole_file_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">create_from_turbomole_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_from_turbomole_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isturbomolelist</span><span class="p">(</span><span class="n">data_list</span><span class="o">=</span><span class="n">file_data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;parsererror, not turbomolelist&quot;</span><span class="p">)</span>
    <span class="n">atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">[</span><span class="s2">&quot;$user-defined bonds&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">:</span>
        <span class="n">final_atom_index</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;$user-defined bonds&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#if [&quot;$end&quot;] in file_data:</span>
        <span class="n">final_atom_index</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;$end&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">final_atom_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span><span class="n">x</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">y</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">z</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;.turbomole&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.read_turbomole" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">read_turbomole</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>filepath</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.XYZMolecule" href="#molecule_lib.XYZMolecule">XYZMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_turbomole</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath not a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath does not exist&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">openfile</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">create_from_turbomole_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="o">=</span><span class="n">file_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.isxyzlist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">isxyzlist</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Return True if datalist fufills .xyz file standards, False otherwise.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data_list</code></b>
            (<code>(list of filelines.split())</code>)
        –
        <div class="doc-md-description">
          <p>Is a list of list of filelines
where each string in the file line seperated by a space is its own
element in the list. data_list[0] is the contains the first line
information of the file and data_list[-1] contains the last line
0 information of the file.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>extralines</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>If True, if there are extra lines in the file, function returns False.
It is quote 'strict' on extra lines if True.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if .xyz file standards are met.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Notes</summary>
  <p>.xyz file standards:
    - first line contains a integer (total amount of atoms in file).
    - third line to last line of file contains only this information,
        'Element   float(x coord)   float(y coord)   float(z coord)'.
    - if total amount of atoms in the file matches the amount of data lines
        found in the file.
    - if there are no empty or blank lines at the end of the file.
    - it is STRICT if extralines if True on the amount of empty line at the end of the file.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isxyzlist</span><span class="p">(</span><span class="n">data_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">extralines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if datalist fufills .xyz file standards, False otherwise.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_list : (list of filelines.split())</span>
<span class="sd">        Is a list of list of filelines</span>
<span class="sd">        where each string in the file line seperated by a space is its own</span>
<span class="sd">        element in the list. data_list[0] is the contains the first line</span>
<span class="sd">        information of the file and data_list[-1] contains the last line</span>
<span class="sd">        0 information of the file.</span>
<span class="sd">    extralines: bool, default True</span>
<span class="sd">        If True, if there are extra lines in the file, function returns False.</span>
<span class="sd">        It is quote &#39;strict&#39; on extra lines if True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if .xyz file standards are met.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    .xyz file standards:</span>
<span class="sd">        - first line contains a integer (total amount of atoms in file).</span>
<span class="sd">        - third line to last line of file contains only this information,</span>
<span class="sd">            &#39;Element   float(x coord)   float(y coord)   float(z coord)&#39;.</span>
<span class="sd">        - if total amount of atoms in the file matches the amount of data lines</span>
<span class="sd">            found in the file.</span>
<span class="sd">        - if there are no empty or blank lines at the end of the file.</span>
<span class="sd">        - it is STRICT if extralines if True on the amount of empty line at the end of the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">4</span>
            <span class="ow">or</span> <span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_ELEMENTS</span>
            <span class="ow">or</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">or</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">False</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">extralines</span><span class="p">:</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="p">[]]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.create_from_xyz_file_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">create_from_xyz_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_from_xyz_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">extralines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isxyzlist</span><span class="p">(</span><span class="n">data_list</span><span class="o">=</span><span class="n">file_data</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="n">extralines</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;parsererror, not xyzlist&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span>
        <span class="n">comment_line</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">atoms</span><span class="o">=</span><span class="p">[</span>
            <span class="n">XYZCoord</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;.xyz&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.read_xyz" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p>Reads .xyz file and returns XYZMolecule instance.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>filepath</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p>Filename (if in current working directory)
or absolute path or os.path.join(os.getcwd(),'filename.xyz')</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>extralines</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>If True, if there are extra lines in the file, function will not return XYZMolecule instance.
It is quote 'strict' on extra lines if True.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.XYZMolecule" href="#molecule_lib.XYZMolecule">XYZMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extralines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads .xyz file and returns XYZMolecule instance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str</span>
<span class="sd">        Filename (if in current working directory)</span>
<span class="sd">        or absolute path or os.path.join(os.getcwd(),&#39;filename.xyz&#39;)</span>
<span class="sd">    extralines: bool, default True</span>
<span class="sd">        If True, if there are extra lines in the file, function will not return XYZMolecule instance.</span>
<span class="sd">        It is quote &#39;strict&#39; on extra lines if True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath not a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath does not exist&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">openfile</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">create_from_xyz_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="o">=</span><span class="n">file_data</span><span class="p">,</span> <span class="n">extralines</span><span class="o">=</span><span class="n">extralines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h2 id="more-file-reading-formats">More File Reading Formats</h2>



<div class="doc doc-object doc-function">



<h3 id="molecule_lib._is_xsf_coord_line" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">_is_xsf_coord_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>line</code></b>
            (<code>list[str]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_is_xsf_coord_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    line : list[str]</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">118</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib._determine_rest_of_xsf_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">_determine_rest_of_xsf_file</span><span class="p">(</span><span class="n">rest_of_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>rest_of_file</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>tuple[bool, int]</code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_determine_rest_of_xsf_file</span><span class="p">(</span><span class="n">rest_of_file</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest_of_file : list[list[str]]</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[bool, int]</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">rest_of_file</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_is_xsf_coord_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">rest_of_file</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">_is_xsf_coord_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.isxsflist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">isxsflist</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data_list</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isxsflist</span><span class="p">(</span><span class="n">data_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_list : list[list[str]]</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">[</span><span class="s2">&quot;PRIMVEC&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="ow">and</span> <span class="p">[</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is3byxfloatmatrix</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMVEC&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMVEC&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">3</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span> <span class="ow">or</span> <span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_determine_rest_of_xsf_file</span><span class="p">(</span><span class="n">rest_of_file</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span><span class="p">:])[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">_determine_rest_of_xsf_file</span><span class="p">(</span><span class="n">rest_of_file</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span><span class="p">:])[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="p">[</span><span class="s2">&quot;ATOMS&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_determine_rest_of_xsf_file</span><span class="p">(</span><span class="n">rest_of_file</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;ATOMS&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.create_from_xsf_file_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">create_from_xsf_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>file_data</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a> | <a class="autorefs autorefs-internal" title="molecule_lib.XYZMolecule" href="#molecule_lib.XYZMolecule">XYZMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_from_xsf_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span> <span class="o">|</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_data : list[list[str]]</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule | XYZMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isxsflist</span><span class="p">(</span><span class="n">data_list</span><span class="o">=</span><span class="n">file_data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;parsererror, not xsflist&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">[</span><span class="s2">&quot;CONVVEC&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">:</span>
        <span class="c1"># pass #abc format</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;read_xsf(): DEPRECATION WARNING: Not currently supported to save CONVVEC Information&quot;</span><span class="p">)</span> <span class="c1"># yapf: disable</span>
    <span class="k">if</span> <span class="p">[</span><span class="s2">&quot;ATOMS&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">:</span>
        <span class="n">xyz_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">XYZCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">tot</span> <span class="o">=</span> <span class="n">_determine_rest_of_xsf_file</span><span class="p">(</span><span class="n">rest_of_file</span><span class="o">=</span><span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;ATOMS&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;ATOMS&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;ATOMS&quot;</span><span class="p">])</span><span class="o">+</span><span class="n">tot</span><span class="p">]:</span>
            <span class="n">xyz_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">ACCEPTED_ELEMENTS</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span><span class="n">x</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">y</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">z</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
        <span class="k">return</span> <span class="n">XYZMolecule</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">xyz_atoms</span><span class="p">,</span> <span class="n">comment_line</span><span class="o">=</span><span class="s2">&quot;from .xsf format&quot;</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;.xsf&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">abc_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">tot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMCOORD&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">tot</span><span class="p">]:</span>
            <span class="n">abc_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ABCCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">ACCEPTED_ELEMENTS</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span><span class="n">a</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">b</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">c</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
        <span class="n">uc_ind</span> <span class="o">=</span> <span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s2">&quot;PRIMVEC&quot;</span><span class="p">])</span>
        <span class="n">unitcell</span> <span class="o">=</span> <span class="n">LatticeMatrix</span><span class="p">(</span><span class="n">constant</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">vector_1</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])],</span>
                                 <span class="n">vector_2</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])],</span>
                                 <span class="n">vector_3</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="n">uc_ind</span><span class="o">+</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">])])</span>
        <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="n">unitcell</span><span class="p">,</span><span class="n">positional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">atoms</span><span class="o">=</span><span class="n">abc_atoms</span><span class="p">,</span><span class="n">comment_line</span><span class="o">=</span><span class="s2">&quot;from xsf file&quot;</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;.xsf&quot;</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.read_xsf" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">read_xsf</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>filepath</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a> | <a class="autorefs autorefs-internal" title="molecule_lib.XYZMolecule" href="#molecule_lib.XYZMolecule">XYZMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Notes</summary>
  <p>Need to ensure keywords for xyzmolecule is only ATOMS
and keyword for abcmolecule is "primvec" and "primcoord"</p>
</details>
          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_xsf</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span> <span class="o">|</span> <span class="n">XYZMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule | XYZMolecule</span>
<span class="sd">        _description_</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Need to ensure keywords for xyzmolecule is only ATOMS</span>
<span class="sd">    and keyword for abcmolecule is &quot;primvec&quot; and &quot;primcoord&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath not a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath does not exist&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">openfile</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">create_from_xsf_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="o">=</span><span class="n">file_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.issiestalist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">issiestalist</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data_list</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">issiestalist</span><span class="p">(</span><span class="n">data_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_list : list[list[str]]</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;LatticeConstant&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">[</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="ow">and</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">])])</span> <span class="c1"># yapf: disable</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_is3byxfloatmatrix</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">])]):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">[</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;AtomicCoordinatesAndAtomicSpecies&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="ow">or</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;AtomicCoordinatesAndAtomicSpecies&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;AtomicCoordinatesAndAtomicSpecies&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">data_list</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;AtomicCoordinatesAndAtomicSpecies&#39;</span><span class="p">])]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">_isfloatstr</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.create_from_siesta_file_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">create_from_siesta_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>file_data</code></b>
            (<code>list[list[str]]</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_from_siesta_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_data : list[list[str]]</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">issiestalist</span><span class="p">(</span><span class="n">data_list</span><span class="o">=</span><span class="n">file_data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;parsererror, not siestalist&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;LatticeConstant&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">constant</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">lattice</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;LatticeVectors&#39;</span><span class="p">])]</span>
    <span class="n">unitcell</span> <span class="o">=</span> <span class="n">LatticeMatrix</span><span class="p">(</span>
        <span class="n">constant</span><span class="o">=</span><span class="n">constant</span><span class="p">,</span>
        <span class="n">vector_1</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])],</span>
        <span class="n">vector_2</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])],</span>
        <span class="n">vector_3</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">lattice</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])])</span>
    <span class="n">abc_atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ABCCoord</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;%block&#39;</span><span class="p">,</span> <span class="s1">&#39;AtomicCoordinatesAndAtomicSpecies&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">file_data</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%e</span><span class="s1">ndblock&#39;</span><span class="p">,</span> <span class="s1">&#39;AtomicCoordinatesAndAtomicSpecies&#39;</span><span class="p">])]:</span>
        <span class="n">abc_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ABCCoord</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="n">ACCEPTED_ELEMENTS</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])],</span><span class="n">a</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">b</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">c</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">ABCMolecule</span><span class="p">(</span><span class="n">unitcell</span><span class="o">=</span><span class="n">unitcell</span><span class="p">,</span> <span class="n">positional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="n">abc_atoms</span><span class="p">,</span><span class="n">comment_line</span><span class="o">=</span><span class="s2">&quot;from siesta input deck&quot;</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;.fdf&quot;</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="molecule_lib.read_siesta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">molecule_lib</span><span class="o">.</span><span class="n">read_siesta</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents first">
  
      <p><em>summary</em></p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>filepath</code></b>
            (<code>str</code>)
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="molecule_lib.ABCMolecule" href="#molecule_lib.ABCMolecule">ABCMolecule</a></code>
        –
        <div class="doc-md-description">
          <p><em>description</em></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>molecule_lib\__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_siesta</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ABCMolecule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str</span>
<span class="sd">        _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ABCMolecule</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath not a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Filepath does not exist&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openfile</span><span class="p">:</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">openfile</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">create_from_siesta_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="o">=</span><span class="n">file_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 Jeremy Schroeder
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="mailto:jeremynschroeder@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.depts.ttu.edu/me/combustionlab/" target="_blank" rel="noopener" title="www.depts.ttu.edu" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M32 32C14.3 32 0 46.3 0 64s14.3 32 32 32h128v352c0 17.7 14.3 32 32 32s32-14.3 32-32V96h128c17.7 0 32-14.3 32-32s-14.3-32-32-32H32z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigate.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>